<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Production-ready LiteLLM deployment with job-based cost tracking for multi-tenant SaaS applications"><meta name=author content="SaaS LiteLLM Team"><link href=../credit-system/ rel=prev><link href=../streaming-architecture/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.21"><title>Model Resolution - SaaS LiteLLM API Documentation</title><link rel=stylesheet href=../../assets/stylesheets/main.2a3383ac.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=deep-purple> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#model-resolution-reference class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="SaaS LiteLLM API Documentation" class="md-header__button md-logo" aria-label="SaaS LiteLLM API Documentation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M7 7H5a2 2 0 0 0-2 2v8h2v-4h2v4h2V9a2 2 0 0 0-2-2m0 4H5V9h2m7-2h-4v10h2v-4h2a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2m0 4h-2V9h2m6 0v6h1v2h-4v-2h1V9h-1V7h4v2Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> SaaS LiteLLM API Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Model Resolution </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=deep-purple aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=deep-purple aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/GittieLabs/SaasLiteLLM title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> GittieLabs/SaasLiteLLM </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../getting-started/introduction/ class=md-tabs__link> Getting Started </a> </li> <li class=md-tabs__item> <a href=../../admin-dashboard/overview/ class=md-tabs__link> Admin Dashboard </a> </li> <li class=md-tabs__item> <a href=../../integration/overview/ class=md-tabs__link> Integration </a> </li> <li class=md-tabs__item> <a href=../../downloads/typed-client/ class=md-tabs__link> Downloads </a> </li> <li class=md-tabs__item> <a href=../../examples/basic-usage/ class=md-tabs__link> Examples </a> </li> <li class=md-tabs__item> <a href=../../api-reference/overview/ class=md-tabs__link> API Reference </a> </li> <li class=md-tabs__item> <a href=../../deployment/local-development/ class=md-tabs__link> Deployment </a> </li> <li class=md-tabs__item> <a href=../../testing/overview/ class=md-tabs__link> Testing </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../database-schema/ class=md-tabs__link> Reference </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="SaaS LiteLLM API Documentation" class="md-nav__button md-logo" aria-label="SaaS LiteLLM API Documentation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M7 7H5a2 2 0 0 0-2 2v8h2v-4h2v4h2V9a2 2 0 0 0-2-2m0 4H5V9h2m7-2h-4v10h2v-4h2a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2m0 4h-2V9h2m6 0v6h1v2h-4v-2h1V9h-1V7h4v2Z"/></svg> </a> SaaS LiteLLM API Documentation </label> <div class=md-nav__source> <a href=https://github.com/GittieLabs/SaasLiteLLM title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> GittieLabs/SaasLiteLLM </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Getting Started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../getting-started/introduction/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/quickstart/ class=md-nav__link> <span class=md-ellipsis> Quickstart </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/architecture/ class=md-nav__link> <span class=md-ellipsis> Architecture </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Admin Dashboard </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Admin Dashboard </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../admin-dashboard/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../admin-dashboard/authentication/ class=md-nav__link> <span class=md-ellipsis> Authentication </span> </a> </li> <li class=md-nav__item> <a href=../../admin-dashboard/organizations/ class=md-nav__link> <span class=md-ellipsis> Organizations </span> </a> </li> <li class=md-nav__item> <a href=../../admin-dashboard/teams/ class=md-nav__link> <span class=md-ellipsis> Teams </span> </a> </li> <li class=md-nav__item> <a href=../../admin-dashboard/model-access-groups/ class=md-nav__link> <span class=md-ellipsis> Model Access Groups </span> </a> </li> <li class=md-nav__item> <a href=../../admin-dashboard/model-aliases/ class=md-nav__link> <span class=md-ellipsis> Model Aliases </span> </a> </li> <li class=md-nav__item> <a href=../../admin-dashboard/credits/ class=md-nav__link> <span class=md-ellipsis> Credits </span> </a> </li> <li class=md-nav__item> <a href=../../admin-dashboard/suspend-pause/ class=md-nav__link> <span class=md-ellipsis> Suspend & Pause </span> </a> </li> <li class=md-nav__item> <a href=../../admin-dashboard/monitoring/ class=md-nav__link> <span class=md-ellipsis> Monitoring </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Integration </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Integration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../integration/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../integration-flow/ class=md-nav__link> <span class=md-ellipsis> Complete Integration Flow </span> </a> </li> <li class=md-nav__item> <a href=../../integration/authentication/ class=md-nav__link> <span class=md-ellipsis> Team Authentication </span> </a> </li> <li class=md-nav__item> <a href=../../integration/job-workflow/ class=md-nav__link> <span class=md-ellipsis> Job Workflow </span> </a> </li> <li class=md-nav__item> <a href=../../integration/non-streaming/ class=md-nav__link> <span class=md-ellipsis> Non-Streaming </span> </a> </li> <li class=md-nav__item> <a href=../../integration/streaming/ class=md-nav__link> <span class=md-ellipsis> Streaming </span> </a> </li> <li class=md-nav__item> <a href=../../integration/typed-client/ class=md-nav__link> <span class=md-ellipsis> Typed Client </span> </a> </li> <li class=md-nav__item> <a href=../../integration/structured-outputs/ class=md-nav__link> <span class=md-ellipsis> Structured Outputs </span> </a> </li> <li class=md-nav__item> <a href=../../integration/error-handling/ class=md-nav__link> <span class=md-ellipsis> Error Handling </span> </a> </li> <li class=md-nav__item> <a href=../../integration/best-practices/ class=md-nav__link> <span class=md-ellipsis> Best Practices </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Downloads </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Downloads </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../downloads/typed-client/ class=md-nav__link> <span class=md-ellipsis> Typed Client </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Examples </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../examples/basic-usage/ class=md-nav__link> <span class=md-ellipsis> Basic Usage </span> </a> </li> <li class=md-nav__item> <a href=../../examples/streaming-examples/ class=md-nav__link> <span class=md-ellipsis> Streaming </span> </a> </li> <li class=md-nav__item> <a href=../../examples/structured-outputs/ class=md-nav__link> <span class=md-ellipsis> Structured Outputs </span> </a> </li> <li class=md-nav__item> <a href=../../examples/full-chain/ class=md-nav__link> <span class=md-ellipsis> Full Chain </span> </a> </li> <li class=md-nav__item> <a href=../../examples/agent-integration/ class=md-nav__link> <span class=md-ellipsis> Agent Integration </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> API Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> API Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../api-reference/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../api-reference/jobs/ class=md-nav__link> <span class=md-ellipsis> Jobs </span> </a> </li> <li class=md-nav__item> <a href=../../api-reference/llm-calls/ class=md-nav__link> <span class=md-ellipsis> LLM Calls </span> </a> </li> <li class=md-nav__item> <a href=../../api-reference/teams/ class=md-nav__link> <span class=md-ellipsis> Teams </span> </a> </li> <li class=md-nav__item> <a href=../../api-reference/organizations/ class=md-nav__link> <span class=md-ellipsis> Organizations </span> </a> </li> <li class=md-nav__item> <a href=../../api-reference/admin-users/ class=md-nav__link> <span class=md-ellipsis> Admin Users </span> </a> </li> <li class=md-nav__item> <a href=../../api-reference/redoc-link/ class=md-nav__link> <span class=md-ellipsis> Full API Docs (ReDoc) </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> <span class=md-ellipsis> Deployment </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Deployment </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../deployment/local-development/ class=md-nav__link> <span class=md-ellipsis> Local Development </span> </a> </li> <li class=md-nav__item> <a href=../../deployment/railway/ class=md-nav__link> <span class=md-ellipsis> Railway </span> </a> </li> <li class=md-nav__item> <a href=../../deployment/railway-networking/ class=md-nav__link> <span class=md-ellipsis> Railway Networking </span> </a> </li> <li class=md-nav__item> <a href=../../deployment/railway-cors-setup/ class=md-nav__link> <span class=md-ellipsis> Railway CORS Setup </span> </a> </li> <li class=md-nav__item> <a href=../../deployment/cors-and-authentication/ class=md-nav__link> <span class=md-ellipsis> CORS & Authentication </span> </a> </li> <li class=md-nav__item> <a href=../../deployment/environment-variables/ class=md-nav__link> <span class=md-ellipsis> Environment Variables </span> </a> </li> <li class=md-nav__item> <a href=../../litellm-setup/ class=md-nav__link> <span class=md-ellipsis> LiteLLM Setup </span> </a> </li> <li class=md-nav__item> <a href=../../integration-flow/ class=md-nav__link> <span class=md-ellipsis> Complete Integration Flow </span> </a> </li> <li class=md-nav__item> <a href=../../deployment/docker/ class=md-nav__link> <span class=md-ellipsis> Docker </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9 id=__nav_9_label tabindex=0> <span class=md-ellipsis> Testing </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Testing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../testing/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../testing/integration-tests/ class=md-nav__link> <span class=md-ellipsis> Integration Tests </span> </a> </li> <li class=md-nav__item> <a href=../../testing/troubleshooting/ class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_10 checked> <label class=md-nav__link for=__nav_10 id=__nav_10_label tabindex> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_10_label aria-expanded=true> <label class=md-nav__title for=__nav_10> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../database-schema/ class=md-nav__link> <span class=md-ellipsis> Database Schema </span> </a> </li> <li class=md-nav__item> <a href=../credit-system/ class=md-nav__link> <span class=md-ellipsis> Credit System </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Model Resolution </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Model Resolution </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#core-concepts class=md-nav__link> <span class=md-ellipsis> Core Concepts </span> </a> <nav class=md-nav aria-label="Core Concepts"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#model-groups class=md-nav__link> <span class=md-ellipsis> Model Groups </span> </a> </li> <li class=md-nav__item> <a href=#why-model-groups class=md-nav__link> <span class=md-ellipsis> Why Model Groups? </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#database-schema class=md-nav__link> <span class=md-ellipsis> Database Schema </span> </a> <nav class=md-nav aria-label="Database Schema"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#model_groups-table class=md-nav__link> <span class=md-ellipsis> model_groups Table </span> </a> </li> <li class=md-nav__item> <a href=#model_group_models-table class=md-nav__link> <span class=md-ellipsis> model_group_models Table </span> </a> </li> <li class=md-nav__item> <a href=#team_model_groups-table class=md-nav__link> <span class=md-ellipsis> team_model_groups Table </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#model-resolver-service class=md-nav__link> <span class=md-ellipsis> Model Resolver Service </span> </a> <nav class=md-nav aria-label="Model Resolver Service"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#location class=md-nav__link> <span class=md-ellipsis> Location </span> </a> </li> <li class=md-nav__item> <a href=#class-definition class=md-nav__link> <span class=md-ellipsis> Class Definition </span> </a> </li> <li class=md-nav__item> <a href=#key-methods class=md-nav__link> <span class=md-ellipsis> Key Methods </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#resolution-flow class=md-nav__link> <span class=md-ellipsis> Resolution Flow </span> </a> <nav class=md-nav aria-label="Resolution Flow"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#complete-resolution-process class=md-nav__link> <span class=md-ellipsis> Complete Resolution Process </span> </a> </li> <li class=md-nav__item> <a href=#step-by-step class=md-nav__link> <span class=md-ellipsis> Step-by-Step </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#api-integration class=md-nav__link> <span class=md-ellipsis> API Integration </span> </a> <nav class=md-nav aria-label="API Integration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#make-llm-call-with-model-group class=md-nav__link> <span class=md-ellipsis> Make LLM Call with Model Group </span> </a> </li> <li class=md-nav__item> <a href=#querying-model-usage class=md-nav__link> <span class=md-ellipsis> Querying Model Usage </span> </a> </li> <li class=md-nav__item> <a href=#response-format class=md-nav__link> <span class=md-ellipsis> Response Format </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#error-handling class=md-nav__link> <span class=md-ellipsis> Error Handling </span> </a> <nav class=md-nav aria-label="Error Handling"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#modelresolutionerror class=md-nav__link> <span class=md-ellipsis> ModelResolutionError </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#common-operations class=md-nav__link> <span class=md-ellipsis> Common Operations </span> </a> <nav class=md-nav aria-label="Common Operations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-create-model-group class=md-nav__link> <span class=md-ellipsis> 1. Create Model Group </span> </a> </li> <li class=md-nav__item> <a href=#2-assign-model-group-to-team class=md-nav__link> <span class=md-ellipsis> 2. Assign Model Group to Team </span> </a> </li> <li class=md-nav__item> <a href=#3-update-primary-model class=md-nav__link> <span class=md-ellipsis> 3. Update Primary Model </span> </a> </li> <li class=md-nav__item> <a href=#4-add-fallback-model class=md-nav__link> <span class=md-ellipsis> 4. Add Fallback Model </span> </a> </li> <li class=md-nav__item> <a href=#5-disable-model-without-deletion class=md-nav__link> <span class=md-ellipsis> 5. Disable Model (without deletion) </span> </a> </li> <li class=md-nav__item> <a href=#6-revoke-team-access class=md-nav__link> <span class=md-ellipsis> 6. Revoke Team Access </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#analytics-queries class=md-nav__link> <span class=md-ellipsis> Analytics Queries </span> </a> <nav class=md-nav aria-label="Analytics Queries"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#model-group-usage-by-team class=md-nav__link> <span class=md-ellipsis> Model Group Usage by Team </span> </a> </li> <li class=md-nav__item> <a href=#model-group-access-report class=md-nav__link> <span class=md-ellipsis> Model Group Access Report </span> </a> </li> <li class=md-nav__item> <a href=#teams-without-model-group-access class=md-nav__link> <span class=md-ellipsis> Teams Without Model Group Access </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#best-practices class=md-nav__link> <span class=md-ellipsis> Best Practices </span> </a> <nav class=md-nav aria-label="Best Practices"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-use-descriptive-group-names class=md-nav__link> <span class=md-ellipsis> 1. Use Descriptive Group Names </span> </a> </li> <li class=md-nav__item> <a href=#2-always-have-fallbacks class=md-nav__link> <span class=md-ellipsis> 2. Always Have Fallbacks </span> </a> </li> <li class=md-nav__item> <a href=#3-test-model-changes class=md-nav__link> <span class=md-ellipsis> 3. Test Model Changes </span> </a> </li> <li class=md-nav__item> <a href=#4-track-resolution-history class=md-nav__link> <span class=md-ellipsis> 4. Track Resolution History </span> </a> </li> <li class=md-nav__item> <a href=#5-document-model-group-purposes class=md-nav__link> <span class=md-ellipsis> 5. Document Model Group Purposes </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#advanced-patterns class=md-nav__link> <span class=md-ellipsis> Advanced Patterns </span> </a> <nav class=md-nav aria-label="Advanced Patterns"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#per-team-model-overrides class=md-nav__link> <span class=md-ellipsis> Per-Team Model Overrides </span> </a> </li> <li class=md-nav__item> <a href=#cost-based-routing class=md-nav__link> <span class=md-ellipsis> Cost-Based Routing </span> </a> </li> <li class=md-nav__item> <a href=#ab-testing-models class=md-nav__link> <span class=md-ellipsis> A/B Testing Models </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#see-also class=md-nav__link> <span class=md-ellipsis> See Also </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../streaming-architecture/ class=md-nav__link> <span class=md-ellipsis> Streaming Architecture </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#core-concepts class=md-nav__link> <span class=md-ellipsis> Core Concepts </span> </a> <nav class=md-nav aria-label="Core Concepts"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#model-groups class=md-nav__link> <span class=md-ellipsis> Model Groups </span> </a> </li> <li class=md-nav__item> <a href=#why-model-groups class=md-nav__link> <span class=md-ellipsis> Why Model Groups? </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#database-schema class=md-nav__link> <span class=md-ellipsis> Database Schema </span> </a> <nav class=md-nav aria-label="Database Schema"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#model_groups-table class=md-nav__link> <span class=md-ellipsis> model_groups Table </span> </a> </li> <li class=md-nav__item> <a href=#model_group_models-table class=md-nav__link> <span class=md-ellipsis> model_group_models Table </span> </a> </li> <li class=md-nav__item> <a href=#team_model_groups-table class=md-nav__link> <span class=md-ellipsis> team_model_groups Table </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#model-resolver-service class=md-nav__link> <span class=md-ellipsis> Model Resolver Service </span> </a> <nav class=md-nav aria-label="Model Resolver Service"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#location class=md-nav__link> <span class=md-ellipsis> Location </span> </a> </li> <li class=md-nav__item> <a href=#class-definition class=md-nav__link> <span class=md-ellipsis> Class Definition </span> </a> </li> <li class=md-nav__item> <a href=#key-methods class=md-nav__link> <span class=md-ellipsis> Key Methods </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#resolution-flow class=md-nav__link> <span class=md-ellipsis> Resolution Flow </span> </a> <nav class=md-nav aria-label="Resolution Flow"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#complete-resolution-process class=md-nav__link> <span class=md-ellipsis> Complete Resolution Process </span> </a> </li> <li class=md-nav__item> <a href=#step-by-step class=md-nav__link> <span class=md-ellipsis> Step-by-Step </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#api-integration class=md-nav__link> <span class=md-ellipsis> API Integration </span> </a> <nav class=md-nav aria-label="API Integration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#make-llm-call-with-model-group class=md-nav__link> <span class=md-ellipsis> Make LLM Call with Model Group </span> </a> </li> <li class=md-nav__item> <a href=#querying-model-usage class=md-nav__link> <span class=md-ellipsis> Querying Model Usage </span> </a> </li> <li class=md-nav__item> <a href=#response-format class=md-nav__link> <span class=md-ellipsis> Response Format </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#error-handling class=md-nav__link> <span class=md-ellipsis> Error Handling </span> </a> <nav class=md-nav aria-label="Error Handling"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#modelresolutionerror class=md-nav__link> <span class=md-ellipsis> ModelResolutionError </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#common-operations class=md-nav__link> <span class=md-ellipsis> Common Operations </span> </a> <nav class=md-nav aria-label="Common Operations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-create-model-group class=md-nav__link> <span class=md-ellipsis> 1. Create Model Group </span> </a> </li> <li class=md-nav__item> <a href=#2-assign-model-group-to-team class=md-nav__link> <span class=md-ellipsis> 2. Assign Model Group to Team </span> </a> </li> <li class=md-nav__item> <a href=#3-update-primary-model class=md-nav__link> <span class=md-ellipsis> 3. Update Primary Model </span> </a> </li> <li class=md-nav__item> <a href=#4-add-fallback-model class=md-nav__link> <span class=md-ellipsis> 4. Add Fallback Model </span> </a> </li> <li class=md-nav__item> <a href=#5-disable-model-without-deletion class=md-nav__link> <span class=md-ellipsis> 5. Disable Model (without deletion) </span> </a> </li> <li class=md-nav__item> <a href=#6-revoke-team-access class=md-nav__link> <span class=md-ellipsis> 6. Revoke Team Access </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#analytics-queries class=md-nav__link> <span class=md-ellipsis> Analytics Queries </span> </a> <nav class=md-nav aria-label="Analytics Queries"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#model-group-usage-by-team class=md-nav__link> <span class=md-ellipsis> Model Group Usage by Team </span> </a> </li> <li class=md-nav__item> <a href=#model-group-access-report class=md-nav__link> <span class=md-ellipsis> Model Group Access Report </span> </a> </li> <li class=md-nav__item> <a href=#teams-without-model-group-access class=md-nav__link> <span class=md-ellipsis> Teams Without Model Group Access </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#best-practices class=md-nav__link> <span class=md-ellipsis> Best Practices </span> </a> <nav class=md-nav aria-label="Best Practices"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-use-descriptive-group-names class=md-nav__link> <span class=md-ellipsis> 1. Use Descriptive Group Names </span> </a> </li> <li class=md-nav__item> <a href=#2-always-have-fallbacks class=md-nav__link> <span class=md-ellipsis> 2. Always Have Fallbacks </span> </a> </li> <li class=md-nav__item> <a href=#3-test-model-changes class=md-nav__link> <span class=md-ellipsis> 3. Test Model Changes </span> </a> </li> <li class=md-nav__item> <a href=#4-track-resolution-history class=md-nav__link> <span class=md-ellipsis> 4. Track Resolution History </span> </a> </li> <li class=md-nav__item> <a href=#5-document-model-group-purposes class=md-nav__link> <span class=md-ellipsis> 5. Document Model Group Purposes </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#advanced-patterns class=md-nav__link> <span class=md-ellipsis> Advanced Patterns </span> </a> <nav class=md-nav aria-label="Advanced Patterns"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#per-team-model-overrides class=md-nav__link> <span class=md-ellipsis> Per-Team Model Overrides </span> </a> </li> <li class=md-nav__item> <a href=#cost-based-routing class=md-nav__link> <span class=md-ellipsis> Cost-Based Routing </span> </a> </li> <li class=md-nav__item> <a href=#ab-testing-models class=md-nav__link> <span class=md-ellipsis> A/B Testing Models </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#see-also class=md-nav__link> <span class=md-ellipsis> See Also </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=model-resolution-reference>Model Resolution Reference<a class=headerlink href=#model-resolution-reference title="Permanent link">&para;</a></h1> <p>Complete technical reference for the model group resolution system in SaaS LiteLLM. This system allows you to define named model groups (like "ResumeAgent", "ParsingAgent") with primary models and fallbacks, then control which teams have access to which groups.</p> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link">&para;</a></h2> <p>The model resolution system provides:</p> <ul> <li><strong>Named Model Groups</strong>: Abstract model names from implementation (e.g., "ResumeAgent" instead of "gpt-4-turbo")</li> <li><strong>Primary + Fallback Models</strong>: Define fallback chains for reliability</li> <li><strong>Access Control</strong>: Per-team permissions for model groups</li> <li><strong>Easy Model Updates</strong>: Change underlying models without code changes</li> <li><strong>Model Versioning</strong>: Switch between model versions centrally</li> </ul> <h2 id=core-concepts>Core Concepts<a class=headerlink href=#core-concepts title="Permanent link">&para;</a></h2> <h3 id=model-groups>Model Groups<a class=headerlink href=#model-groups title="Permanent link">&para;</a></h3> <p>A <strong>model group</strong> is a named collection of models with a priority order:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>ResumeAgent:
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>  Priority 0 (Primary): gpt-4-turbo
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>  Priority 1 (Fallback): gpt-4
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>  Priority 2 (Fallback): gpt-3.5-turbo
</span></code></pre></div> <p>Your application requests <code>model_group="ResumeAgent"</code>, and the system resolves it to the actual model.</p> <h3 id=why-model-groups>Why Model Groups?<a class=headerlink href=#why-model-groups title="Permanent link">&para;</a></h3> <p><strong>Problem:</strong> Hard-coding model names creates maintenance nightmares:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=c1># ❌ Bad - Hard-coded model names</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=n>response</span> <span class=o>=</span> <span class=n>litellm</span><span class=o>.</span><span class=n>completion</span><span class=p>(</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>    <span class=n>model</span><span class=o>=</span><span class=s2>&quot;gpt-4-turbo-2024-04-09&quot;</span><span class=p>,</span>  <span class=c1># What if we want to change this?</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>    <span class=n>messages</span><span class=o>=</span><span class=n>messages</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=p>)</span>
</span></code></pre></div> <p><strong>Solution:</strong> Use model groups:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=c1># ✅ Good - Abstract model group</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=n>response</span> <span class=o>=</span> <span class=n>saas_api</span><span class=o>.</span><span class=n>llm_call</span><span class=p>(</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>    <span class=n>job_id</span><span class=o>=</span><span class=n>job_id</span><span class=p>,</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>    <span class=n>model_group</span><span class=o>=</span><span class=s2>&quot;ResumeAgent&quot;</span><span class=p>,</span>  <span class=c1># Resolved to actual model by system</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>    <span class=n>messages</span><span class=o>=</span><span class=n>messages</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=p>)</span>
</span></code></pre></div> <p><strong>Benefits:</strong></p> <ul> <li>Update models centrally in database (no code changes)</li> <li>Different teams can use different models for same group</li> <li>Easy A/B testing of models</li> <li>Rollback model changes instantly</li> <li>Add fallbacks without code changes</li> </ul> <hr> <h2 id=database-schema>Database Schema<a class=headerlink href=#database-schema title="Permanent link">&para;</a></h2> <h3 id=model_groups-table>model_groups Table<a class=headerlink href=#model_groups-table title="Permanent link">&para;</a></h3> <p>Defines named model groups.</p> <div class="language-sql highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>model_groups</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=w>    </span><span class=n>model_group_id</span><span class=w> </span><span class=n>UUID</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=n>gen_random_uuid</span><span class=p>(),</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=w>    </span><span class=n>group_name</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span><span class=w> </span><span class=k>UNIQUE</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=w>    </span><span class=n>display_name</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>200</span><span class=p>),</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=w>    </span><span class=n>description</span><span class=w> </span><span class=nb>TEXT</span><span class=p>,</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=w>    </span><span class=n>status</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>50</span><span class=p>)</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;active&#39;</span><span class=p>,</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=w>    </span><span class=n>created_at</span><span class=w> </span><span class=k>TIMESTAMP</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=n>NOW</span><span class=p>(),</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=w>    </span><span class=n>updated_at</span><span class=w> </span><span class=k>TIMESTAMP</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=n>NOW</span><span class=p>()</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=p>);</span>
</span></code></pre></div> <p><strong>Columns:</strong></p> <ul> <li><code>model_group_id</code>: Unique identifier</li> <li><code>group_name</code>: Code-friendly name (e.g., "ResumeAgent")</li> <li><code>display_name</code>: Human-readable name (e.g., "Resume Analysis Agent")</li> <li><code>description</code>: Purpose and usage notes</li> <li><code>status</code>: <code>active</code> or <code>inactive</code> (inactive groups can't be used)</li> </ul> <p><strong>Example:</strong></p> <div class="language-sql highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>model_groups</span><span class=w> </span><span class=p>(</span><span class=n>group_name</span><span class=p>,</span><span class=w> </span><span class=n>display_name</span><span class=p>,</span><span class=w> </span><span class=n>description</span><span class=p>)</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=k>VALUES</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=w>    </span><span class=s1>&#39;ResumeAgent&#39;</span><span class=p>,</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=w>    </span><span class=s1>&#39;Resume Analysis Agent&#39;</span><span class=p>,</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=w>    </span><span class=s1>&#39;High-quality model for resume parsing, skills extraction, and job matching&#39;</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=p>);</span>
</span></code></pre></div> <hr> <h3 id=model_group_models-table>model_group_models Table<a class=headerlink href=#model_group_models-table title="Permanent link">&para;</a></h3> <p>Maps models to groups with priority for fallback handling.</p> <div class="language-sql highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>model_group_models</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=n>UUID</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=n>gen_random_uuid</span><span class=p>(),</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=w>    </span><span class=n>model_group_id</span><span class=w> </span><span class=n>UUID</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=n>model_groups</span><span class=p>(</span><span class=n>model_group_id</span><span class=p>)</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>DELETE</span><span class=w> </span><span class=k>CASCADE</span><span class=p>,</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=w>    </span><span class=n>model_name</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>200</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=w>    </span><span class=n>priority</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=w>    </span><span class=n>is_active</span><span class=w> </span><span class=nb>BOOLEAN</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>TRUE</span><span class=p>,</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=w>    </span><span class=n>created_at</span><span class=w> </span><span class=k>TIMESTAMP</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=n>NOW</span><span class=p>()</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=p>);</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_model_group_models_lookup</span>
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=n>model_group_models</span><span class=p>(</span><span class=n>model_group_id</span><span class=p>,</span><span class=w> </span><span class=n>priority</span><span class=p>,</span><span class=w> </span><span class=n>is_active</span><span class=p>);</span>
</span></code></pre></div> <p><strong>Columns:</strong></p> <ul> <li><code>model_group_id</code>: Parent group</li> <li><code>model_name</code>: LiteLLM model identifier (e.g., "gpt-4-turbo", "claude-3-opus")</li> <li><code>priority</code>: 0 = primary, 1 = first fallback, 2 = second fallback, etc.</li> <li><code>is_active</code>: Whether this model is enabled (allows disabling without deletion)</li> </ul> <p><strong>Priority System:</strong></p> <ul> <li><strong>Priority 0</strong>: Primary model (always tried first)</li> <li><strong>Priority 1</strong>: First fallback (used if primary fails or unavailable)</li> <li><strong>Priority 2+</strong>: Additional fallbacks</li> </ul> <p><strong>Example:</strong></p> <div class="language-sql highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=c1>-- Get model group ID</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=k>SELECT</span><span class=w> </span><span class=n>model_group_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>model_groups</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>group_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;ResumeAgent&#39;</span><span class=p>;</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=c1>-- Returns: &#39;a1b2c3d4-...&#39;</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=c1>-- Add models with priorities</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>model_group_models</span><span class=w> </span><span class=p>(</span><span class=n>model_group_id</span><span class=p>,</span><span class=w> </span><span class=n>model_name</span><span class=p>,</span><span class=w> </span><span class=n>priority</span><span class=p>)</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=k>VALUES</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=w>    </span><span class=p>(</span><span class=s1>&#39;a1b2c3d4-...&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;gpt-4-turbo&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>),</span><span class=w>        </span><span class=c1>-- Primary</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=w>    </span><span class=p>(</span><span class=s1>&#39;a1b2c3d4-...&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;gpt-4&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>),</span><span class=w>              </span><span class=c1>-- First fallback</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=w>    </span><span class=p>(</span><span class=s1>&#39;a1b2c3d4-...&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;gpt-3.5-turbo&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>);</span><span class=w>      </span><span class=c1>-- Second fallback</span>
</span></code></pre></div> <hr> <h3 id=team_model_groups-table>team_model_groups Table<a class=headerlink href=#team_model_groups-table title="Permanent link">&para;</a></h3> <p>Junction table controlling which teams have access to which model groups.</p> <div class="language-sql highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>team_model_groups</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=n>UUID</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=n>gen_random_uuid</span><span class=p>(),</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=w>    </span><span class=n>team_id</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=w>    </span><span class=n>model_group_id</span><span class=w> </span><span class=n>UUID</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=n>model_groups</span><span class=p>(</span><span class=n>model_group_id</span><span class=p>)</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>DELETE</span><span class=w> </span><span class=k>CASCADE</span><span class=p>,</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=w>    </span><span class=n>assigned_at</span><span class=w> </span><span class=k>TIMESTAMP</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=n>NOW</span><span class=p>(),</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=w>    </span><span class=k>CONSTRAINT</span><span class=w> </span><span class=n>unique_team_model_group</span><span class=w> </span><span class=k>UNIQUE</span><span class=p>(</span><span class=n>team_id</span><span class=p>,</span><span class=w> </span><span class=n>model_group_id</span><span class=p>)</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=p>);</span>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_team_model_groups_team</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>team_model_groups</span><span class=p>(</span><span class=n>team_id</span><span class=p>);</span>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_team_model_groups_group</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>team_model_groups</span><span class=p>(</span><span class=n>model_group_id</span><span class=p>);</span>
</span></code></pre></div> <p><strong>Columns:</strong></p> <ul> <li><code>team_id</code>: Team identifier</li> <li><code>model_group_id</code>: Model group this team can access</li> <li><code>assigned_at</code>: When access was granted</li> </ul> <p><strong>Example:</strong></p> <div class="language-sql highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=c1>-- Grant team access to model group</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>team_model_groups</span><span class=w> </span><span class=p>(</span><span class=n>team_id</span><span class=p>,</span><span class=w> </span><span class=n>model_group_id</span><span class=p>)</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=k>SELECT</span><span class=w> </span><span class=s1>&#39;team-alpha&#39;</span><span class=p>,</span><span class=w> </span><span class=n>model_group_id</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=k>FROM</span><span class=w> </span><span class=n>model_groups</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=k>WHERE</span><span class=w> </span><span class=n>group_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;ResumeAgent&#39;</span><span class=p>;</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=c1>-- Grant access to multiple groups</span>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>team_model_groups</span><span class=w> </span><span class=p>(</span><span class=n>team_id</span><span class=p>,</span><span class=w> </span><span class=n>model_group_id</span><span class=p>)</span>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=k>SELECT</span><span class=w> </span><span class=s1>&#39;team-alpha&#39;</span><span class=p>,</span><span class=w> </span><span class=n>model_group_id</span>
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a><span class=k>FROM</span><span class=w> </span><span class=n>model_groups</span>
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a><span class=k>WHERE</span><span class=w> </span><span class=n>group_name</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;ResumeAgent&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;ParsingAgent&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;ChatAgent&#39;</span><span class=p>);</span>
</span></code></pre></div> <hr> <h2 id=model-resolver-service>Model Resolver Service<a class=headerlink href=#model-resolver-service title="Permanent link">&para;</a></h2> <p>The <code>ModelResolver</code> service handles model group resolution and access control.</p> <h3 id=location>Location<a class=headerlink href=#location title="Permanent link">&para;</a></h3> <p><code>src/services/model_resolver.py</code></p> <h3 id=class-definition>Class Definition<a class=headerlink href=#class-definition title="Permanent link">&para;</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=k>class</span><span class=w> </span><span class=nc>ModelResolver</span><span class=p>:</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>db</span><span class=p>:</span> <span class=n>Session</span><span class=p>):</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>        <span class=bp>self</span><span class=o>.</span><span class=n>db</span> <span class=o>=</span> <span class=n>db</span>
</span></code></pre></div> <hr> <h3 id=key-methods>Key Methods<a class=headerlink href=#key-methods title="Permanent link">&para;</a></h3> <h4 id=1-verify_team_access>1. verify_team_access()<a class=headerlink href=#1-verify_team_access title="Permanent link">&para;</a></h4> <p>Check if a team has access to a specific model group.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=k>def</span><span class=w> </span><span class=nf>verify_team_access</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>team_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>model_group_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>    <span class=c1># Get model group</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>    <span class=n>model_group</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>db</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=n>ModelGroup</span><span class=p>)</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>        <span class=n>ModelGroup</span><span class=o>.</span><span class=n>group_name</span> <span class=o>==</span> <span class=n>model_group_name</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>    <span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>model_group</span><span class=p>:</span>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a>        <span class=k>return</span> <span class=kc>False</span>
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a>
</span><span id=__span-10-10><a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a>    <span class=c1># Check if team has this group assigned</span>
</span><span id=__span-10-11><a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a>    <span class=n>assignment</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>db</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=n>TeamModelGroup</span><span class=p>)</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span>
</span><span id=__span-10-12><a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a>        <span class=n>and_</span><span class=p>(</span>
</span><span id=__span-10-13><a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a>            <span class=n>TeamModelGroup</span><span class=o>.</span><span class=n>team_id</span> <span class=o>==</span> <span class=n>team_id</span><span class=p>,</span>
</span><span id=__span-10-14><a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a>            <span class=n>TeamModelGroup</span><span class=o>.</span><span class=n>model_group_id</span> <span class=o>==</span> <span class=n>model_group</span><span class=o>.</span><span class=n>model_group_id</span>
</span><span id=__span-10-15><a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a>        <span class=p>)</span>
</span><span id=__span-10-16><a id=__codelineno-10-16 name=__codelineno-10-16 href=#__codelineno-10-16></a>    <span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span><span id=__span-10-17><a id=__codelineno-10-17 name=__codelineno-10-17 href=#__codelineno-10-17></a>
</span><span id=__span-10-18><a id=__codelineno-10-18 name=__codelineno-10-18 href=#__codelineno-10-18></a>    <span class=k>return</span> <span class=n>assignment</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span>
</span></code></pre></div> <p><strong>Returns:</strong> <code>True</code> if team has access, <code>False</code> otherwise</p> <p><strong>Example:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=n>resolver</span> <span class=o>=</span> <span class=n>ModelResolver</span><span class=p>(</span><span class=n>db</span><span class=p>)</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=k>if</span> <span class=n>resolver</span><span class=o>.</span><span class=n>verify_team_access</span><span class=p>(</span><span class=s2>&quot;team-alpha&quot;</span><span class=p>,</span> <span class=s2>&quot;ResumeAgent&quot;</span><span class=p>):</span>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Access granted&quot;</span><span class=p>)</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=k>else</span><span class=p>:</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Access denied&quot;</span><span class=p>)</span>
</span></code></pre></div> <hr> <h4 id=2-resolve_model_group>2. resolve_model_group()<a class=headerlink href=#2-resolve_model_group title="Permanent link">&para;</a></h4> <p>Resolve a model group name to actual model(s).</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=k>def</span><span class=w> </span><span class=nf>resolve_model_group</span><span class=p>(</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>    <span class=n>team_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a>    <span class=n>model_group_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a>    <span class=n>include_fallbacks</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]:</span>
</span></code></pre></div> <p><strong>Parameters:</strong></p> <ul> <li><code>team_id</code>: Team requesting the model</li> <li><code>model_group_name</code>: Name of model group (e.g., "ResumeAgent")</li> <li><code>include_fallbacks</code>: Whether to return fallback models (default: <code>True</code>)</li> </ul> <p><strong>Returns:</strong> Tuple of <code>(primary_model, [fallback_models])</code></p> <p><strong>Raises:</strong> <code>ModelResolutionError</code> if: - Team doesn't have access to group - Model group not found or inactive - No active models configured for group</p> <p><strong>Implementation:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=k>def</span><span class=w> </span><span class=nf>resolve_model_group</span><span class=p>(</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>    <span class=n>team_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a>    <span class=n>model_group_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>    <span class=n>include_fallbacks</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]:</span>
</span><span id=__span-13-7><a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a>    <span class=c1># 1. Verify access</span>
</span><span id=__span-13-8><a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a>    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>verify_team_access</span><span class=p>(</span><span class=n>team_id</span><span class=p>,</span> <span class=n>model_group_name</span><span class=p>):</span>
</span><span id=__span-13-9><a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a>        <span class=k>raise</span> <span class=n>ModelResolutionError</span><span class=p>(</span>
</span><span id=__span-13-10><a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a>            <span class=sa>f</span><span class=s2>&quot;Team &#39;</span><span class=si>{</span><span class=n>team_id</span><span class=si>}</span><span class=s2>&#39; does not have access to model group &#39;</span><span class=si>{</span><span class=n>model_group_name</span><span class=si>}</span><span class=s2>&#39;&quot;</span>
</span><span id=__span-13-11><a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a>        <span class=p>)</span>
</span><span id=__span-13-12><a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a>
</span><span id=__span-13-13><a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a>    <span class=c1># 2. Get model group</span>
</span><span id=__span-13-14><a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a>    <span class=n>model_group</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>db</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=n>ModelGroup</span><span class=p>)</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span>
</span><span id=__span-13-15><a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a>        <span class=n>and_</span><span class=p>(</span>
</span><span id=__span-13-16><a id=__codelineno-13-16 name=__codelineno-13-16 href=#__codelineno-13-16></a>            <span class=n>ModelGroup</span><span class=o>.</span><span class=n>group_name</span> <span class=o>==</span> <span class=n>model_group_name</span><span class=p>,</span>
</span><span id=__span-13-17><a id=__codelineno-13-17 name=__codelineno-13-17 href=#__codelineno-13-17></a>            <span class=n>ModelGroup</span><span class=o>.</span><span class=n>status</span> <span class=o>==</span> <span class=s2>&quot;active&quot;</span>
</span><span id=__span-13-18><a id=__codelineno-13-18 name=__codelineno-13-18 href=#__codelineno-13-18></a>        <span class=p>)</span>
</span><span id=__span-13-19><a id=__codelineno-13-19 name=__codelineno-13-19 href=#__codelineno-13-19></a>    <span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span><span id=__span-13-20><a id=__codelineno-13-20 name=__codelineno-13-20 href=#__codelineno-13-20></a>
</span><span id=__span-13-21><a id=__codelineno-13-21 name=__codelineno-13-21 href=#__codelineno-13-21></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>model_group</span><span class=p>:</span>
</span><span id=__span-13-22><a id=__codelineno-13-22 name=__codelineno-13-22 href=#__codelineno-13-22></a>        <span class=k>raise</span> <span class=n>ModelResolutionError</span><span class=p>(</span>
</span><span id=__span-13-23><a id=__codelineno-13-23 name=__codelineno-13-23 href=#__codelineno-13-23></a>            <span class=sa>f</span><span class=s2>&quot;Model group &#39;</span><span class=si>{</span><span class=n>model_group_name</span><span class=si>}</span><span class=s2>&#39; not found or inactive&quot;</span>
</span><span id=__span-13-24><a id=__codelineno-13-24 name=__codelineno-13-24 href=#__codelineno-13-24></a>        <span class=p>)</span>
</span><span id=__span-13-25><a id=__codelineno-13-25 name=__codelineno-13-25 href=#__codelineno-13-25></a>
</span><span id=__span-13-26><a id=__codelineno-13-26 name=__codelineno-13-26 href=#__codelineno-13-26></a>    <span class=c1># 3. Get models sorted by priority</span>
</span><span id=__span-13-27><a id=__codelineno-13-27 name=__codelineno-13-27 href=#__codelineno-13-27></a>    <span class=n>models</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>db</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=n>ModelGroupModel</span><span class=p>)</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span>
</span><span id=__span-13-28><a id=__codelineno-13-28 name=__codelineno-13-28 href=#__codelineno-13-28></a>        <span class=n>and_</span><span class=p>(</span>
</span><span id=__span-13-29><a id=__codelineno-13-29 name=__codelineno-13-29 href=#__codelineno-13-29></a>            <span class=n>ModelGroupModel</span><span class=o>.</span><span class=n>model_group_id</span> <span class=o>==</span> <span class=n>model_group</span><span class=o>.</span><span class=n>model_group_id</span><span class=p>,</span>
</span><span id=__span-13-30><a id=__codelineno-13-30 name=__codelineno-13-30 href=#__codelineno-13-30></a>            <span class=n>ModelGroupModel</span><span class=o>.</span><span class=n>is_active</span> <span class=o>==</span> <span class=kc>True</span>
</span><span id=__span-13-31><a id=__codelineno-13-31 name=__codelineno-13-31 href=#__codelineno-13-31></a>        <span class=p>)</span>
</span><span id=__span-13-32><a id=__codelineno-13-32 name=__codelineno-13-32 href=#__codelineno-13-32></a>    <span class=p>)</span><span class=o>.</span><span class=n>order_by</span><span class=p>(</span><span class=n>ModelGroupModel</span><span class=o>.</span><span class=n>priority</span><span class=p>)</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
</span><span id=__span-13-33><a id=__codelineno-13-33 name=__codelineno-13-33 href=#__codelineno-13-33></a>
</span><span id=__span-13-34><a id=__codelineno-13-34 name=__codelineno-13-34 href=#__codelineno-13-34></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>models</span><span class=p>:</span>
</span><span id=__span-13-35><a id=__codelineno-13-35 name=__codelineno-13-35 href=#__codelineno-13-35></a>        <span class=k>raise</span> <span class=n>ModelResolutionError</span><span class=p>(</span>
</span><span id=__span-13-36><a id=__codelineno-13-36 name=__codelineno-13-36 href=#__codelineno-13-36></a>            <span class=sa>f</span><span class=s2>&quot;No active models configured for group &#39;</span><span class=si>{</span><span class=n>model_group_name</span><span class=si>}</span><span class=s2>&#39;&quot;</span>
</span><span id=__span-13-37><a id=__codelineno-13-37 name=__codelineno-13-37 href=#__codelineno-13-37></a>        <span class=p>)</span>
</span><span id=__span-13-38><a id=__codelineno-13-38 name=__codelineno-13-38 href=#__codelineno-13-38></a>
</span><span id=__span-13-39><a id=__codelineno-13-39 name=__codelineno-13-39 href=#__codelineno-13-39></a>    <span class=c1># 4. Return primary + fallbacks</span>
</span><span id=__span-13-40><a id=__codelineno-13-40 name=__codelineno-13-40 href=#__codelineno-13-40></a>    <span class=n>primary_model</span> <span class=o>=</span> <span class=n>models</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>model_name</span>
</span><span id=__span-13-41><a id=__codelineno-13-41 name=__codelineno-13-41 href=#__codelineno-13-41></a>    <span class=n>fallback_models</span> <span class=o>=</span> <span class=p>[</span><span class=n>m</span><span class=o>.</span><span class=n>model_name</span> <span class=k>for</span> <span class=n>m</span> <span class=ow>in</span> <span class=n>models</span><span class=p>[</span><span class=mi>1</span><span class=p>:]]</span> <span class=k>if</span> <span class=n>include_fallbacks</span> <span class=k>else</span> <span class=p>[]</span>
</span><span id=__span-13-42><a id=__codelineno-13-42 name=__codelineno-13-42 href=#__codelineno-13-42></a>
</span><span id=__span-13-43><a id=__codelineno-13-43 name=__codelineno-13-43 href=#__codelineno-13-43></a>    <span class=k>return</span> <span class=n>primary_model</span><span class=p>,</span> <span class=n>fallback_models</span>
</span></code></pre></div> <p><strong>Example:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=n>resolver</span> <span class=o>=</span> <span class=n>ModelResolver</span><span class=p>(</span><span class=n>db</span><span class=p>)</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=n>primary</span><span class=p>,</span> <span class=n>fallbacks</span> <span class=o>=</span> <span class=n>resolver</span><span class=o>.</span><span class=n>resolve_model_group</span><span class=p>(</span>
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>    <span class=n>team_id</span><span class=o>=</span><span class=s2>&quot;team-alpha&quot;</span><span class=p>,</span>
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a>    <span class=n>model_group_name</span><span class=o>=</span><span class=s2>&quot;ResumeAgent&quot;</span>
</span><span id=__span-14-6><a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a><span class=p>)</span>
</span><span id=__span-14-7><a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a>
</span><span id=__span-14-8><a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Primary: </span><span class=si>{</span><span class=n>primary</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-14-9><a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a><span class=c1># Output: Primary: gpt-4-turbo</span>
</span><span id=__span-14-10><a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a>
</span><span id=__span-14-11><a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Fallbacks: </span><span class=si>{</span><span class=n>fallbacks</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-14-12><a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a><span class=c1># Output: Fallbacks: [&#39;gpt-4&#39;, &#39;gpt-3.5-turbo&#39;]</span>
</span></code></pre></div> <hr> <h4 id=3-get_model_group_by_name>3. get_model_group_by_name()<a class=headerlink href=#3-get_model_group_by_name title="Permanent link">&para;</a></h4> <p>Retrieve model group details.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=k>def</span><span class=w> </span><span class=nf>get_model_group_by_name</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>model_group_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ModelGroup</span><span class=p>]:</span>
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>db</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=n>ModelGroup</span><span class=p>)</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span>
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a>        <span class=n>ModelGroup</span><span class=o>.</span><span class=n>group_name</span> <span class=o>==</span> <span class=n>model_group_name</span>
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a>    <span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></code></pre></div> <p><strong>Returns:</strong> <code>ModelGroup</code> object or <code>None</code></p> <hr> <h4 id=4-get_team_model_groups>4. get_team_model_groups()<a class=headerlink href=#4-get_team_model_groups title="Permanent link">&para;</a></h4> <p>Get all model groups assigned to a team.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=k>def</span><span class=w> </span><span class=nf>get_team_model_groups</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>team_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>ModelGroup</span><span class=p>]:</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>    <span class=n>assignments</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>db</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=n>TeamModelGroup</span><span class=p>)</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span>
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a>        <span class=n>TeamModelGroup</span><span class=o>.</span><span class=n>team_id</span> <span class=o>==</span> <span class=n>team_id</span>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a>    <span class=p>)</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a>
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a>    <span class=n>model_group_ids</span> <span class=o>=</span> <span class=p>[</span><span class=n>a</span><span class=o>.</span><span class=n>model_group_id</span> <span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=n>assignments</span><span class=p>]</span>
</span><span id=__span-16-7><a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a>
</span><span id=__span-16-8><a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>db</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=n>ModelGroup</span><span class=p>)</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span>
</span><span id=__span-16-9><a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a>        <span class=n>ModelGroup</span><span class=o>.</span><span class=n>model_group_id</span><span class=o>.</span><span class=n>in_</span><span class=p>(</span><span class=n>model_group_ids</span><span class=p>)</span>
</span><span id=__span-16-10><a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a>    <span class=p>)</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
</span></code></pre></div> <p><strong>Returns:</strong> List of <code>ModelGroup</code> objects</p> <p><strong>Example:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=n>resolver</span> <span class=o>=</span> <span class=n>ModelResolver</span><span class=p>(</span><span class=n>db</span><span class=p>)</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=n>groups</span> <span class=o>=</span> <span class=n>resolver</span><span class=o>.</span><span class=n>get_team_model_groups</span><span class=p>(</span><span class=s2>&quot;team-alpha&quot;</span><span class=p>)</span>
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a>
</span><span id=__span-17-5><a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=k>for</span> <span class=n>group</span> <span class=ow>in</span> <span class=n>groups</span><span class=p>:</span>
</span><span id=__span-17-6><a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;- </span><span class=si>{</span><span class=n>group</span><span class=o>.</span><span class=n>group_name</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>group</span><span class=o>.</span><span class=n>display_name</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-17-7><a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a>
</span><span id=__span-17-8><a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a><span class=c1># Output:</span>
</span><span id=__span-17-9><a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a><span class=c1># - ResumeAgent: Resume Analysis Agent</span>
</span><span id=__span-17-10><a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a><span class=c1># - ParsingAgent: Document Parsing Agent</span>
</span><span id=__span-17-11><a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a><span class=c1># - ChatAgent: General Chat Agent</span>
</span></code></pre></div> <hr> <h2 id=resolution-flow>Resolution Flow<a class=headerlink href=#resolution-flow title="Permanent link">&para;</a></h2> <h3 id=complete-resolution-process>Complete Resolution Process<a class=headerlink href=#complete-resolution-process title="Permanent link">&para;</a></h3> <pre class=mermaid><code>sequenceDiagram
    participant App as Application
    participant API as SaaS API
    participant Resolver as ModelResolver
    participant DB as PostgreSQL
    participant LLM as LiteLLM

    App-&gt;&gt;API: POST /api/jobs/{job_id}/llm-call&lt;br/&gt;model_group="ResumeAgent"
    API-&gt;&gt;Resolver: resolve_model_group(team_id, "ResumeAgent")
    Resolver-&gt;&gt;DB: Check team_model_groups
    DB--&gt;&gt;Resolver: Access granted
    Resolver-&gt;&gt;DB: Get model_groups WHERE group_name='ResumeAgent'
    DB--&gt;&gt;Resolver: model_group_id, status='active'
    Resolver-&gt;&gt;DB: Get model_group_models&lt;br/&gt;ORDER BY priority
    DB--&gt;&gt;Resolver: [gpt-4-turbo, gpt-4, gpt-3.5-turbo]
    Resolver--&gt;&gt;API: primary='gpt-4-turbo', fallbacks=['gpt-4', ...]
    API-&gt;&gt;LLM: Call with model='gpt-4-turbo'
    LLM--&gt;&gt;API: Response
    API-&gt;&gt;DB: Record llm_call:&lt;br/&gt;model_group_used='ResumeAgent'&lt;br/&gt;resolved_model='gpt-4-turbo'
    API--&gt;&gt;App: Response + metadata</code></pre> <h3 id=step-by-step>Step-by-Step<a class=headerlink href=#step-by-step title="Permanent link">&para;</a></h3> <ol> <li><strong>Application makes request</strong> with <code>model_group</code> parameter</li> <li><strong>API receives request</strong>, extracts <code>team_id</code> from auth token</li> <li><strong>Resolver checks access</strong> via <code>team_model_groups</code> table</li> <li><strong>Access granted</strong> → Resolver fetches model group</li> <li><strong>Get models</strong> ordered by priority (ascending)</li> <li><strong>Return primary</strong> (priority 0) and fallbacks (priority 1+)</li> <li><strong>API calls LiteLLM</strong> with resolved primary model</li> <li><strong>Record call</strong> in database with both <code>model_group_used</code> and <code>resolved_model</code></li> <li><strong>Return response</strong> to application</li> </ol> <hr> <h2 id=api-integration>API Integration<a class=headerlink href=#api-integration title="Permanent link">&para;</a></h2> <h3 id=make-llm-call-with-model-group>Make LLM Call with Model Group<a class=headerlink href=#make-llm-call-with-model-group title="Permanent link">&para;</a></h3> <p>From <code>src/saas_api.py</code>:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=nd>@app</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s2>&quot;/api/jobs/</span><span class=si>{job_id}</span><span class=s2>/llm-call&quot;</span><span class=p>)</span>
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>make_llm_call</span><span class=p>(</span>
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a>    <span class=n>job_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a>    <span class=n>request</span><span class=p>:</span> <span class=n>LLMCallRequest</span><span class=p>,</span>  <span class=c1># Contains model_group field</span>
</span><span id=__span-18-5><a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a>    <span class=n>db</span><span class=p>:</span> <span class=n>Session</span> <span class=o>=</span> <span class=n>Depends</span><span class=p>(</span><span class=n>get_db</span><span class=p>),</span>
</span><span id=__span-18-6><a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a>    <span class=n>authenticated_team_id</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Depends</span><span class=p>(</span><span class=n>verify_virtual_key</span><span class=p>)</span>
</span><span id=__span-18-7><a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a><span class=p>):</span>
</span><span id=__span-18-8><a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a>    <span class=c1># Get job</span>
</span><span id=__span-18-9><a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a>    <span class=n>job</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=n>Job</span><span class=p>)</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>Job</span><span class=o>.</span><span class=n>job_id</span> <span class=o>==</span> <span class=n>uuid</span><span class=o>.</span><span class=n>UUID</span><span class=p>(</span><span class=n>job_id</span><span class=p>))</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span><span id=__span-18-10><a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a>
</span><span id=__span-18-11><a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a>    <span class=c1># Verify job belongs to team</span>
</span><span id=__span-18-12><a id=__codelineno-18-12 name=__codelineno-18-12 href=#__codelineno-18-12></a>    <span class=k>if</span> <span class=n>job</span><span class=o>.</span><span class=n>team_id</span> <span class=o>!=</span> <span class=n>authenticated_team_id</span><span class=p>:</span>
</span><span id=__span-18-13><a id=__codelineno-18-13 name=__codelineno-18-13 href=#__codelineno-18-13></a>        <span class=k>raise</span> <span class=n>HTTPException</span><span class=p>(</span><span class=mi>403</span><span class=p>,</span> <span class=s2>&quot;Job does not belong to your team&quot;</span><span class=p>)</span>
</span><span id=__span-18-14><a id=__codelineno-18-14 name=__codelineno-18-14 href=#__codelineno-18-14></a>
</span><span id=__span-18-15><a id=__codelineno-18-15 name=__codelineno-18-15 href=#__codelineno-18-15></a>    <span class=c1># Get team&#39;s virtual key</span>
</span><span id=__span-18-16><a id=__codelineno-18-16 name=__codelineno-18-16 href=#__codelineno-18-16></a>    <span class=n>team_credits</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=n>TeamCredits</span><span class=p>)</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span>
</span><span id=__span-18-17><a id=__codelineno-18-17 name=__codelineno-18-17 href=#__codelineno-18-17></a>        <span class=n>TeamCredits</span><span class=o>.</span><span class=n>team_id</span> <span class=o>==</span> <span class=n>job</span><span class=o>.</span><span class=n>team_id</span>
</span><span id=__span-18-18><a id=__codelineno-18-18 name=__codelineno-18-18 href=#__codelineno-18-18></a>    <span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span><span id=__span-18-19><a id=__codelineno-18-19 name=__codelineno-18-19 href=#__codelineno-18-19></a>
</span><span id=__span-18-20><a id=__codelineno-18-20 name=__codelineno-18-20 href=#__codelineno-18-20></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>team_credits</span><span class=o>.</span><span class=n>virtual_key</span><span class=p>:</span>
</span><span id=__span-18-21><a id=__codelineno-18-21 name=__codelineno-18-21 href=#__codelineno-18-21></a>        <span class=k>raise</span> <span class=n>HTTPException</span><span class=p>(</span><span class=mi>500</span><span class=p>,</span> <span class=s2>&quot;Team has no virtual key configured&quot;</span><span class=p>)</span>
</span><span id=__span-18-22><a id=__codelineno-18-22 name=__codelineno-18-22 href=#__codelineno-18-22></a>
</span><span id=__span-18-23><a id=__codelineno-18-23 name=__codelineno-18-23 href=#__codelineno-18-23></a>    <span class=c1># Resolve model group to actual model</span>
</span><span id=__span-18-24><a id=__codelineno-18-24 name=__codelineno-18-24 href=#__codelineno-18-24></a>    <span class=n>model_resolver</span> <span class=o>=</span> <span class=n>ModelResolver</span><span class=p>(</span><span class=n>db</span><span class=p>)</span>
</span><span id=__span-18-25><a id=__codelineno-18-25 name=__codelineno-18-25 href=#__codelineno-18-25></a>
</span><span id=__span-18-26><a id=__codelineno-18-26 name=__codelineno-18-26 href=#__codelineno-18-26></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-18-27><a id=__codelineno-18-27 name=__codelineno-18-27 href=#__codelineno-18-27></a>        <span class=n>primary_model</span><span class=p>,</span> <span class=n>fallback_models</span> <span class=o>=</span> <span class=n>model_resolver</span><span class=o>.</span><span class=n>resolve_model_group</span><span class=p>(</span>
</span><span id=__span-18-28><a id=__codelineno-18-28 name=__codelineno-18-28 href=#__codelineno-18-28></a>            <span class=n>team_id</span><span class=o>=</span><span class=n>job</span><span class=o>.</span><span class=n>team_id</span><span class=p>,</span>
</span><span id=__span-18-29><a id=__codelineno-18-29 name=__codelineno-18-29 href=#__codelineno-18-29></a>            <span class=n>model_group_name</span><span class=o>=</span><span class=n>request</span><span class=o>.</span><span class=n>model_group</span>
</span><span id=__span-18-30><a id=__codelineno-18-30 name=__codelineno-18-30 href=#__codelineno-18-30></a>        <span class=p>)</span>
</span><span id=__span-18-31><a id=__codelineno-18-31 name=__codelineno-18-31 href=#__codelineno-18-31></a>    <span class=k>except</span> <span class=n>ModelResolutionError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-18-32><a id=__codelineno-18-32 name=__codelineno-18-32 href=#__codelineno-18-32></a>        <span class=k>raise</span> <span class=n>HTTPException</span><span class=p>(</span><span class=mi>403</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>))</span>
</span><span id=__span-18-33><a id=__codelineno-18-33 name=__codelineno-18-33 href=#__codelineno-18-33></a>
</span><span id=__span-18-34><a id=__codelineno-18-34 name=__codelineno-18-34 href=#__codelineno-18-34></a>    <span class=c1># Track model group usage in job</span>
</span><span id=__span-18-35><a id=__codelineno-18-35 name=__codelineno-18-35 href=#__codelineno-18-35></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>job</span><span class=o>.</span><span class=n>model_groups_used</span><span class=p>:</span>
</span><span id=__span-18-36><a id=__codelineno-18-36 name=__codelineno-18-36 href=#__codelineno-18-36></a>        <span class=n>job</span><span class=o>.</span><span class=n>model_groups_used</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-18-37><a id=__codelineno-18-37 name=__codelineno-18-37 href=#__codelineno-18-37></a>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>model_group</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>job</span><span class=o>.</span><span class=n>model_groups_used</span><span class=p>:</span>
</span><span id=__span-18-38><a id=__codelineno-18-38 name=__codelineno-18-38 href=#__codelineno-18-38></a>        <span class=n>job</span><span class=o>.</span><span class=n>model_groups_used</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>model_group</span><span class=p>)</span>
</span><span id=__span-18-39><a id=__codelineno-18-39 name=__codelineno-18-39 href=#__codelineno-18-39></a>        <span class=n>db</span><span class=o>.</span><span class=n>commit</span><span class=p>()</span>
</span><span id=__span-18-40><a id=__codelineno-18-40 name=__codelineno-18-40 href=#__codelineno-18-40></a>
</span><span id=__span-18-41><a id=__codelineno-18-41 name=__codelineno-18-41 href=#__codelineno-18-41></a>    <span class=c1># Call LiteLLM with resolved model</span>
</span><span id=__span-18-42><a id=__codelineno-18-42 name=__codelineno-18-42 href=#__codelineno-18-42></a>    <span class=n>litellm_response</span> <span class=o>=</span> <span class=k>await</span> <span class=n>call_litellm</span><span class=p>(</span>
</span><span id=__span-18-43><a id=__codelineno-18-43 name=__codelineno-18-43 href=#__codelineno-18-43></a>        <span class=n>model</span><span class=o>=</span><span class=n>primary_model</span><span class=p>,</span>  <span class=c1># Use resolved primary model</span>
</span><span id=__span-18-44><a id=__codelineno-18-44 name=__codelineno-18-44 href=#__codelineno-18-44></a>        <span class=n>messages</span><span class=o>=</span><span class=n>request</span><span class=o>.</span><span class=n>messages</span><span class=p>,</span>
</span><span id=__span-18-45><a id=__codelineno-18-45 name=__codelineno-18-45 href=#__codelineno-18-45></a>        <span class=n>virtual_key</span><span class=o>=</span><span class=n>team_credits</span><span class=o>.</span><span class=n>virtual_key</span><span class=p>,</span>
</span><span id=__span-18-46><a id=__codelineno-18-46 name=__codelineno-18-46 href=#__codelineno-18-46></a>        <span class=n>team_id</span><span class=o>=</span><span class=n>job</span><span class=o>.</span><span class=n>team_id</span><span class=p>,</span>
</span><span id=__span-18-47><a id=__codelineno-18-47 name=__codelineno-18-47 href=#__codelineno-18-47></a>        <span class=n>temperature</span><span class=o>=</span><span class=n>request</span><span class=o>.</span><span class=n>temperature</span><span class=p>,</span>
</span><span id=__span-18-48><a id=__codelineno-18-48 name=__codelineno-18-48 href=#__codelineno-18-48></a>        <span class=n>max_tokens</span><span class=o>=</span><span class=n>request</span><span class=o>.</span><span class=n>max_tokens</span>
</span><span id=__span-18-49><a id=__codelineno-18-49 name=__codelineno-18-49 href=#__codelineno-18-49></a>    <span class=p>)</span>
</span><span id=__span-18-50><a id=__codelineno-18-50 name=__codelineno-18-50 href=#__codelineno-18-50></a>
</span><span id=__span-18-51><a id=__codelineno-18-51 name=__codelineno-18-51 href=#__codelineno-18-51></a>    <span class=c1># Store LLM call record</span>
</span><span id=__span-18-52><a id=__codelineno-18-52 name=__codelineno-18-52 href=#__codelineno-18-52></a>    <span class=n>llm_call</span> <span class=o>=</span> <span class=n>LLMCall</span><span class=p>(</span>
</span><span id=__span-18-53><a id=__codelineno-18-53 name=__codelineno-18-53 href=#__codelineno-18-53></a>        <span class=n>job_id</span><span class=o>=</span><span class=n>job</span><span class=o>.</span><span class=n>job_id</span><span class=p>,</span>
</span><span id=__span-18-54><a id=__codelineno-18-54 name=__codelineno-18-54 href=#__codelineno-18-54></a>        <span class=n>model_used</span><span class=o>=</span><span class=n>litellm_response</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;model&quot;</span><span class=p>,</span> <span class=n>primary_model</span><span class=p>),</span>
</span><span id=__span-18-55><a id=__codelineno-18-55 name=__codelineno-18-55 href=#__codelineno-18-55></a>        <span class=n>model_group_used</span><span class=o>=</span><span class=n>request</span><span class=o>.</span><span class=n>model_group</span><span class=p>,</span>  <span class=c1># Track requested group</span>
</span><span id=__span-18-56><a id=__codelineno-18-56 name=__codelineno-18-56 href=#__codelineno-18-56></a>        <span class=n>resolved_model</span><span class=o>=</span><span class=n>primary_model</span><span class=p>,</span>          <span class=c1># Track resolved model</span>
</span><span id=__span-18-57><a id=__codelineno-18-57 name=__codelineno-18-57 href=#__codelineno-18-57></a>        <span class=n>prompt_tokens</span><span class=o>=</span><span class=n>usage</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;prompt_tokens&quot;</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span>
</span><span id=__span-18-58><a id=__codelineno-18-58 name=__codelineno-18-58 href=#__codelineno-18-58></a>        <span class=n>completion_tokens</span><span class=o>=</span><span class=n>usage</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;completion_tokens&quot;</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span>
</span><span id=__span-18-59><a id=__codelineno-18-59 name=__codelineno-18-59 href=#__codelineno-18-59></a>        <span class=n>total_tokens</span><span class=o>=</span><span class=n>usage</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;total_tokens&quot;</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span>
</span><span id=__span-18-60><a id=__codelineno-18-60 name=__codelineno-18-60 href=#__codelineno-18-60></a>        <span class=n>cost_usd</span><span class=o>=</span><span class=n>cost_usd</span><span class=p>,</span>
</span><span id=__span-18-61><a id=__codelineno-18-61 name=__codelineno-18-61 href=#__codelineno-18-61></a>        <span class=n>latency_ms</span><span class=o>=</span><span class=n>latency_ms</span>
</span><span id=__span-18-62><a id=__codelineno-18-62 name=__codelineno-18-62 href=#__codelineno-18-62></a>    <span class=p>)</span>
</span><span id=__span-18-63><a id=__codelineno-18-63 name=__codelineno-18-63 href=#__codelineno-18-63></a>
</span><span id=__span-18-64><a id=__codelineno-18-64 name=__codelineno-18-64 href=#__codelineno-18-64></a>    <span class=n>db</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>llm_call</span><span class=p>)</span>
</span><span id=__span-18-65><a id=__codelineno-18-65 name=__codelineno-18-65 href=#__codelineno-18-65></a>    <span class=n>db</span><span class=o>.</span><span class=n>commit</span><span class=p>()</span>
</span><span id=__span-18-66><a id=__codelineno-18-66 name=__codelineno-18-66 href=#__codelineno-18-66></a>
</span><span id=__span-18-67><a id=__codelineno-18-67 name=__codelineno-18-67 href=#__codelineno-18-67></a>    <span class=k>return</span> <span class=n>response</span>
</span><span id=__span-18-68><a id=__codelineno-18-68 name=__codelineno-18-68 href=#__codelineno-18-68></a>
</span><span id=__span-18-69><a id=__codelineno-18-69 name=__codelineno-18-69 href=#__codelineno-18-69></a><span class=c1>## Model Tracking Fields</span>
</span><span id=__span-18-70><a id=__codelineno-18-70 name=__codelineno-18-70 href=#__codelineno-18-70></a>
</span><span id=__span-18-71><a id=__codelineno-18-71 name=__codelineno-18-71 href=#__codelineno-18-71></a><span class=c1>### Understanding the Three Model Fields</span>
</span><span id=__span-18-72><a id=__codelineno-18-72 name=__codelineno-18-72 href=#__codelineno-18-72></a>
</span><span id=__span-18-73><a id=__codelineno-18-73 name=__codelineno-18-73 href=#__codelineno-18-73></a><span class=n>The</span> <span class=err>`</span><span class=n>llm_calls</span><span class=err>`</span> <span class=n>table</span> <span class=n>tracks</span> <span class=n>three</span> <span class=n>different</span> <span class=n>model</span> <span class=n>identifiers</span> <span class=n>to</span> <span class=n>provide</span> <span class=n>complete</span> <span class=n>visibility</span> <span class=n>into</span> <span class=n>model</span> <span class=n>resolution</span><span class=p>:</span>
</span><span id=__span-18-74><a id=__codelineno-18-74 name=__codelineno-18-74 href=#__codelineno-18-74></a>
</span><span id=__span-18-75><a id=__codelineno-18-75 name=__codelineno-18-75 href=#__codelineno-18-75></a><span class=o>|</span> <span class=n>Field</span> <span class=o>|</span> <span class=n>Type</span> <span class=o>|</span> <span class=n>Description</span> <span class=o>|</span> <span class=n>Example</span> <span class=n>Value</span> <span class=o>|</span>
</span><span id=__span-18-76><a id=__codelineno-18-76 name=__codelineno-18-76 href=#__codelineno-18-76></a><span class=o>|-------|------|-------------|---------------|</span>
</span><span id=__span-18-77><a id=__codelineno-18-77 name=__codelineno-18-77 href=#__codelineno-18-77></a><span class=o>|</span> <span class=err>`</span><span class=n>model_group_used</span><span class=err>`</span> <span class=o>|</span> <span class=n>string</span> <span class=o>|</span> <span class=n>The</span> <span class=n>model</span> <span class=n>group</span> <span class=n>name</span> <span class=n>requested</span> <span class=n>by</span> <span class=n>the</span> <span class=n>application</span> <span class=o>|</span> <span class=err>`</span><span class=s2>&quot;ResumeAgent&quot;</span><span class=err>`</span> <span class=o>|</span>
</span><span id=__span-18-78><a id=__codelineno-18-78 name=__codelineno-18-78 href=#__codelineno-18-78></a><span class=o>|</span> <span class=err>`</span><span class=n>resolved_model</span><span class=err>`</span> <span class=o>|</span> <span class=n>string</span> <span class=o>|</span> <span class=n>The</span> <span class=n>model</span> <span class=n>your</span> <span class=n>system</span> <span class=n>resolved</span> <span class=n>to</span> <span class=kn>from</span><span class=w> </span><span class=nn>the</span> <span class=n>model</span> <span class=n>group</span> <span class=o>|</span> <span class=err>`</span><span class=s2>&quot;gpt-4-turbo&quot;</span><span class=err>`</span> <span class=o>|</span>
</span><span id=__span-18-79><a id=__codelineno-18-79 name=__codelineno-18-79 href=#__codelineno-18-79></a><span class=o>|</span> <span class=err>`</span><span class=n>model_used</span><span class=err>`</span> <span class=o>|</span> <span class=n>string</span> <span class=o>|</span> <span class=n>The</span> <span class=n>actual</span> <span class=n>model</span> <span class=n>LiteLLM</span> <span class=n>used</span> <span class=p>(</span><span class=n>may</span> <span class=n>differ</span> <span class=k>if</span> <span class=n>LiteLLM</span> <span class=n>applies</span> <span class=n>fallbacks</span><span class=p>)</span> <span class=o>|</span> <span class=err>`</span><span class=s2>&quot;gpt-4-turbo-2024-04-09&quot;</span><span class=err>`</span> <span class=o>|</span>
</span><span id=__span-18-80><a id=__codelineno-18-80 name=__codelineno-18-80 href=#__codelineno-18-80></a>
</span><span id=__span-18-81><a id=__codelineno-18-81 name=__codelineno-18-81 href=#__codelineno-18-81></a><span class=c1>### Why Three Fields?</span>
</span><span id=__span-18-82><a id=__codelineno-18-82 name=__codelineno-18-82 href=#__codelineno-18-82></a>
</span><span id=__span-18-83><a id=__codelineno-18-83 name=__codelineno-18-83 href=#__codelineno-18-83></a><span class=n>This</span> <span class=n>three</span><span class=o>-</span><span class=n>tier</span> <span class=n>tracking</span> <span class=n>provides</span> <span class=n>complete</span> <span class=n>audit</span> <span class=n>trail</span><span class=p>:</span>
</span><span id=__span-18-84><a id=__codelineno-18-84 name=__codelineno-18-84 href=#__codelineno-18-84></a>
</span><span id=__span-18-85><a id=__codelineno-18-85 name=__codelineno-18-85 href=#__codelineno-18-85></a><span class=o>**</span><span class=n>Example</span> <span class=n>Scenario</span><span class=p>:</span><span class=o>**</span>
</span><span id=__span-18-86><a id=__codelineno-18-86 name=__codelineno-18-86 href=#__codelineno-18-86></a>
</span><span id=__span-18-87><a id=__codelineno-18-87 name=__codelineno-18-87 href=#__codelineno-18-87></a><span class=mf>1.</span> <span class=o>**</span><span class=n>Application</span> <span class=n>requests</span><span class=o>**</span> <span class=err>`</span><span class=n>model_group</span><span class=o>=</span><span class=s2>&quot;ResumeAgent&quot;</span><span class=err>`</span>
</span><span id=__span-18-88><a id=__codelineno-18-88 name=__codelineno-18-88 href=#__codelineno-18-88></a><span class=mf>2.</span> <span class=o>**</span><span class=n>Your</span> <span class=n>system</span> <span class=n>resolves</span><span class=o>**</span> <span class=n>to</span> <span class=err>`</span><span class=n>resolved_model</span><span class=o>=</span><span class=s2>&quot;gpt-4-turbo&quot;</span><span class=err>`</span> <span class=p>(</span><span class=kn>from</span><span class=w> </span><span class=nn>model</span> <span class=n>group</span> <span class=n>configuration</span><span class=p>)</span>
</span><span id=__span-18-89><a id=__codelineno-18-89 name=__codelineno-18-89 href=#__codelineno-18-89></a><span class=mf>3.</span> <span class=o>**</span><span class=n>LiteLLM</span> <span class=n>returns</span><span class=o>**</span> <span class=err>`</span><span class=n>model</span><span class=o>=</span><span class=s2>&quot;gpt-4-turbo-2024-04-09&quot;</span><span class=err>`</span> <span class=p>(</span><span class=n>specific</span> <span class=n>version</span><span class=o>/</span><span class=n>deployment</span><span class=p>)</span>
</span><span id=__span-18-90><a id=__codelineno-18-90 name=__codelineno-18-90 href=#__codelineno-18-90></a>
</span><span id=__span-18-91><a id=__codelineno-18-91 name=__codelineno-18-91 href=#__codelineno-18-91></a><span class=o>**</span><span class=n>Tracking</span> <span class=n>All</span> <span class=n>Three</span> <span class=n>Allows</span><span class=p>:</span><span class=o>**</span>
</span><span id=__span-18-92><a id=__codelineno-18-92 name=__codelineno-18-92 href=#__codelineno-18-92></a>
</span><span id=__span-18-93><a id=__codelineno-18-93 name=__codelineno-18-93 href=#__codelineno-18-93></a><span class=o>-</span> <span class=o>**</span><span class=err>`</span><span class=n>model_group_used</span><span class=err>`</span><span class=o>**</span><span class=p>:</span> <span class=n>Track</span> <span class=n>which</span> <span class=n>logical</span> <span class=n>model</span> <span class=n>groups</span> <span class=n>are</span> <span class=n>most</span> <span class=n>popular</span>
</span><span id=__span-18-94><a id=__codelineno-18-94 name=__codelineno-18-94 href=#__codelineno-18-94></a><span class=o>-</span> <span class=o>**</span><span class=err>`</span><span class=n>resolved_model</span><span class=err>`</span><span class=o>**</span><span class=p>:</span> <span class=n>Verify</span> <span class=n>your</span> <span class=n>resolution</span> <span class=n>logic</span> <span class=n>worked</span> <span class=n>correctly</span>
</span><span id=__span-18-95><a id=__codelineno-18-95 name=__codelineno-18-95 href=#__codelineno-18-95></a><span class=o>-</span> <span class=o>**</span><span class=err>`</span><span class=n>model_used</span><span class=err>`</span><span class=o>**</span><span class=p>:</span> <span class=n>See</span> <span class=n>the</span> <span class=n>actual</span> <span class=n>model</span><span class=o>/</span><span class=n>version</span> <span class=n>LiteLLM</span> <span class=n>used</span> <span class=p>(</span><span class=n>important</span> <span class=k>for</span> <span class=n>cost</span> <span class=n>tracking</span> <span class=ow>and</span> <span class=n>debugging</span><span class=p>)</span>
</span><span id=__span-18-96><a id=__codelineno-18-96 name=__codelineno-18-96 href=#__codelineno-18-96></a>
</span><span id=__span-18-97><a id=__codelineno-18-97 name=__codelineno-18-97 href=#__codelineno-18-97></a><span class=c1>### Typical Values</span>
</span><span id=__span-18-98><a id=__codelineno-18-98 name=__codelineno-18-98 href=#__codelineno-18-98></a>
</span><span id=__span-18-99><a id=__codelineno-18-99 name=__codelineno-18-99 href=#__codelineno-18-99></a><span class=err>```</span><span class=n>python</span>
</span><span id=__span-18-100><a id=__codelineno-18-100 name=__codelineno-18-100 href=#__codelineno-18-100></a><span class=c1># Example 1: Standard resolution</span>
</span><span id=__span-18-101><a id=__codelineno-18-101 name=__codelineno-18-101 href=#__codelineno-18-101></a><span class=p>{</span>
</span><span id=__span-18-102><a id=__codelineno-18-102 name=__codelineno-18-102 href=#__codelineno-18-102></a>    <span class=s2>&quot;model_group_used&quot;</span><span class=p>:</span> <span class=s2>&quot;ResumeAgent&quot;</span><span class=p>,</span>      <span class=c1># What app requested</span>
</span><span id=__span-18-103><a id=__codelineno-18-103 name=__codelineno-18-103 href=#__codelineno-18-103></a>    <span class=s2>&quot;resolved_model&quot;</span><span class=p>:</span> <span class=s2>&quot;gpt-4-turbo&quot;</span><span class=p>,</span>        <span class=c1># What you resolved to</span>
</span><span id=__span-18-104><a id=__codelineno-18-104 name=__codelineno-18-104 href=#__codelineno-18-104></a>    <span class=s2>&quot;model_used&quot;</span><span class=p>:</span> <span class=s2>&quot;gpt-4-turbo-2024-04-09&quot;</span>  <span class=c1># What LiteLLM used</span>
</span><span id=__span-18-105><a id=__codelineno-18-105 name=__codelineno-18-105 href=#__codelineno-18-105></a><span class=p>}</span>
</span><span id=__span-18-106><a id=__codelineno-18-106 name=__codelineno-18-106 href=#__codelineno-18-106></a>
</span><span id=__span-18-107><a id=__codelineno-18-107 name=__codelineno-18-107 href=#__codelineno-18-107></a><span class=c1># Example 2: Direct model request (not using model groups)</span>
</span><span id=__span-18-108><a id=__codelineno-18-108 name=__codelineno-18-108 href=#__codelineno-18-108></a><span class=p>{</span>
</span><span id=__span-18-109><a id=__codelineno-18-109 name=__codelineno-18-109 href=#__codelineno-18-109></a>    <span class=s2>&quot;model_group_used&quot;</span><span class=p>:</span> <span class=n>null</span><span class=p>,</span>               <span class=c1># No group used</span>
</span><span id=__span-18-110><a id=__codelineno-18-110 name=__codelineno-18-110 href=#__codelineno-18-110></a>    <span class=s2>&quot;resolved_model&quot;</span><span class=p>:</span> <span class=s2>&quot;gpt-4&quot;</span><span class=p>,</span>              <span class=c1># Direct model request</span>
</span><span id=__span-18-111><a id=__codelineno-18-111 name=__codelineno-18-111 href=#__codelineno-18-111></a>    <span class=s2>&quot;model_used&quot;</span><span class=p>:</span> <span class=s2>&quot;gpt-4-0613&quot;</span>              <span class=c1># Specific version used</span>
</span><span id=__span-18-112><a id=__codelineno-18-112 name=__codelineno-18-112 href=#__codelineno-18-112></a><span class=p>}</span>
</span><span id=__span-18-113><a id=__codelineno-18-113 name=__codelineno-18-113 href=#__codelineno-18-113></a>
</span><span id=__span-18-114><a id=__codelineno-18-114 name=__codelineno-18-114 href=#__codelineno-18-114></a><span class=c1># Example 3: Fallback scenario</span>
</span><span id=__span-18-115><a id=__codelineno-18-115 name=__codelineno-18-115 href=#__codelineno-18-115></a><span class=p>{</span>
</span><span id=__span-18-116><a id=__codelineno-18-116 name=__codelineno-18-116 href=#__codelineno-18-116></a>    <span class=s2>&quot;model_group_used&quot;</span><span class=p>:</span> <span class=s2>&quot;ResumeAgent&quot;</span><span class=p>,</span>      <span class=c1># What app requested</span>
</span><span id=__span-18-117><a id=__codelineno-18-117 name=__codelineno-18-117 href=#__codelineno-18-117></a>    <span class=s2>&quot;resolved_model&quot;</span><span class=p>:</span> <span class=s2>&quot;gpt-4-turbo&quot;</span><span class=p>,</span>        <span class=c1># What you resolved to</span>
</span><span id=__span-18-118><a id=__codelineno-18-118 name=__codelineno-18-118 href=#__codelineno-18-118></a>    <span class=s2>&quot;model_used&quot;</span><span class=p>:</span> <span class=s2>&quot;gpt-4&quot;</span>                   <span class=c1># LiteLLM fell back to this</span>
</span><span id=__span-18-119><a id=__codelineno-18-119 name=__codelineno-18-119 href=#__codelineno-18-119></a><span class=p>}</span>
</span></code></pre></div> <h3 id=querying-model-usage>Querying Model Usage<a class=headerlink href=#querying-model-usage title="Permanent link">&para;</a></h3> <p><strong>Track most-used model groups:</strong></p> <div class="language-sql highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=k>SELECT</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=w>    </span><span class=n>model_group_used</span><span class=p>,</span>
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=w>    </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>call_count</span><span class=p>,</span>
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=w>    </span><span class=k>AVG</span><span class=p>(</span><span class=n>cost_usd</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>avg_cost</span><span class=p>,</span>
</span><span id=__span-19-5><a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=w>    </span><span class=k>AVG</span><span class=p>(</span><span class=n>latency_ms</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>avg_latency</span>
</span><span id=__span-19-6><a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a><span class=k>FROM</span><span class=w> </span><span class=n>llm_calls</span>
</span><span id=__span-19-7><a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a><span class=k>WHERE</span><span class=w> </span><span class=n>model_group_used</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-19-8><a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a><span class=k>AND</span><span class=w> </span><span class=n>created_at</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=n>NOW</span><span class=p>()</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nb>INTERVAL</span><span class=w> </span><span class=s1>&#39;7 days&#39;</span>
</span><span id=__span-19-9><a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>model_group_used</span>
</span><span id=__span-19-10><a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>call_count</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span>
</span></code></pre></div> <p><strong>Verify resolution accuracy:</strong></p> <div class="language-sql highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=c1>-- Check if resolved models match actual models used</span>
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a><span class=k>SELECT</span>
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=w>    </span><span class=n>model_group_used</span><span class=p>,</span>
</span><span id=__span-20-4><a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=w>    </span><span class=n>resolved_model</span><span class=p>,</span>
</span><span id=__span-20-5><a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=w>    </span><span class=n>model_used</span><span class=p>,</span>
</span><span id=__span-20-6><a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a><span class=w>    </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>instances</span>
</span><span id=__span-20-7><a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a><span class=k>FROM</span><span class=w> </span><span class=n>llm_calls</span>
</span><span id=__span-20-8><a id=__codelineno-20-8 name=__codelineno-20-8 href=#__codelineno-20-8></a><span class=k>WHERE</span><span class=w> </span><span class=n>model_group_used</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-20-9><a id=__codelineno-20-9 name=__codelineno-20-9 href=#__codelineno-20-9></a><span class=k>AND</span><span class=w> </span><span class=n>created_at</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=n>NOW</span><span class=p>()</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nb>INTERVAL</span><span class=w> </span><span class=s1>&#39;1 day&#39;</span>
</span><span id=__span-20-10><a id=__codelineno-20-10 name=__codelineno-20-10 href=#__codelineno-20-10></a><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>model_group_used</span><span class=p>,</span><span class=w> </span><span class=n>resolved_model</span><span class=p>,</span><span class=w> </span><span class=n>model_used</span>
</span><span id=__span-20-11><a id=__codelineno-20-11 name=__codelineno-20-11 href=#__codelineno-20-11></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>instances</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span>
</span></code></pre></div> <p><strong>Detect unexpected fallbacks:</strong></p> <p><div class="language-sql highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=c1>-- Find cases where LiteLLM used a different model than resolved</span>
</span><span id=__span-21-2><a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a><span class=k>SELECT</span>
</span><span id=__span-21-3><a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=w>    </span><span class=n>job_id</span><span class=p>,</span>
</span><span id=__span-21-4><a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=w>    </span><span class=n>model_group_used</span><span class=p>,</span>
</span><span id=__span-21-5><a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a><span class=w>    </span><span class=n>resolved_model</span><span class=p>,</span>
</span><span id=__span-21-6><a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a><span class=w>    </span><span class=n>model_used</span><span class=p>,</span>
</span><span id=__span-21-7><a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a><span class=w>    </span><span class=n>created_at</span>
</span><span id=__span-21-8><a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a><span class=k>FROM</span><span class=w> </span><span class=n>llm_calls</span>
</span><span id=__span-21-9><a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a><span class=k>WHERE</span><span class=w> </span><span class=n>resolved_model</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>model_used</span>
</span><span id=__span-21-10><a id=__codelineno-21-10 name=__codelineno-21-10 href=#__codelineno-21-10></a><span class=k>AND</span><span class=w> </span><span class=n>model_group_used</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-21-11><a id=__codelineno-21-11 name=__codelineno-21-11 href=#__codelineno-21-11></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>created_at</span><span class=w> </span><span class=k>DESC</span>
</span><span id=__span-21-12><a id=__codelineno-21-12 name=__codelineno-21-12 href=#__codelineno-21-12></a><span class=k>LIMIT</span><span class=w> </span><span class=mi>100</span><span class=p>;</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a>### Request Format
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a>
</span><span id=__span-22-3><a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a>```json
</span><span id=__span-22-4><a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a>POST /api/jobs/{job_id}/llm-call
</span><span id=__span-22-5><a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a>{
</span><span id=__span-22-6><a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a>  &quot;model_group&quot;: &quot;ResumeAgent&quot;,
</span><span id=__span-22-7><a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a>  &quot;messages&quot;: [
</span><span id=__span-22-8><a id=__codelineno-22-8 name=__codelineno-22-8 href=#__codelineno-22-8></a>    {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;Analyze this resume...&quot;}
</span><span id=__span-22-9><a id=__codelineno-22-9 name=__codelineno-22-9 href=#__codelineno-22-9></a>  ],
</span><span id=__span-22-10><a id=__codelineno-22-10 name=__codelineno-22-10 href=#__codelineno-22-10></a>  &quot;temperature&quot;: 0.7,
</span><span id=__span-22-11><a id=__codelineno-22-11 name=__codelineno-22-11 href=#__codelineno-22-11></a>  &quot;max_tokens&quot;: 2000,
</span><span id=__span-22-12><a id=__codelineno-22-12 name=__codelineno-22-12 href=#__codelineno-22-12></a>  &quot;purpose&quot;: &quot;Skills extraction&quot;
</span><span id=__span-22-13><a id=__codelineno-22-13 name=__codelineno-22-13 href=#__codelineno-22-13></a>}
</span></code></pre></div></p> <h3 id=response-format>Response Format<a class=headerlink href=#response-format title="Permanent link">&para;</a></h3> <div class="language-json highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=p>{</span>
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a><span class=w>  </span><span class=nt>&quot;call_id&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;call-uuid-123&quot;</span><span class=p>,</span>
</span><span id=__span-23-3><a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=w>  </span><span class=nt>&quot;response&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-23-4><a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a><span class=w>    </span><span class=nt>&quot;content&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;This resume shows strong Python skills...&quot;</span><span class=p>,</span>
</span><span id=__span-23-5><a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=w>    </span><span class=nt>&quot;finish_reason&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;stop&quot;</span>
</span><span id=__span-23-6><a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a><span class=w>  </span><span class=p>},</span>
</span><span id=__span-23-7><a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a><span class=w>  </span><span class=nt>&quot;metadata&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-23-8><a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a><span class=w>    </span><span class=nt>&quot;tokens_used&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1850</span><span class=p>,</span>
</span><span id=__span-23-9><a id=__codelineno-23-9 name=__codelineno-23-9 href=#__codelineno-23-9></a><span class=w>    </span><span class=nt>&quot;latency_ms&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>2340</span><span class=p>,</span>
</span><span id=__span-23-10><a id=__codelineno-23-10 name=__codelineno-23-10 href=#__codelineno-23-10></a><span class=w>    </span><span class=nt>&quot;model_group&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;ResumeAgent&quot;</span>
</span><span id=__span-23-11><a id=__codelineno-23-11 name=__codelineno-23-11 href=#__codelineno-23-11></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-23-12><a id=__codelineno-23-12 name=__codelineno-23-12 href=#__codelineno-23-12></a><span class=p>}</span>
</span></code></pre></div> <p>Note: The actual resolved model is <strong>not</strong> exposed to the client (keeps implementation details hidden).</p> <hr> <h2 id=error-handling>Error Handling<a class=headerlink href=#error-handling title="Permanent link">&para;</a></h2> <h3 id=modelresolutionerror>ModelResolutionError<a class=headerlink href=#modelresolutionerror title="Permanent link">&para;</a></h3> <p>Raised when resolution fails.</p> <p><strong>Scenarios:</strong></p> <ol> <li> <p><strong>Team lacks access:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a>ModelResolutionError: Team &#39;team-alpha&#39; does not have access to model group &#39;ResumeAgent&#39;
</span></code></pre></div></p> </li> <li> <p><strong>Model group not found:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a>ModelResolutionError: Model group &#39;InvalidAgent&#39; not found or inactive
</span></code></pre></div></p> </li> <li> <p><strong>No models configured:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-26-1><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a>ModelResolutionError: No active models configured for group &#39;ResumeAgent&#39;
</span></code></pre></div></p> </li> </ol> <p><strong>HTTP Response:</strong></p> <div class="language-json highlight"><pre><span></span><code><span id=__span-27-1><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=p>{</span>
</span><span id=__span-27-2><a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a><span class=w>  </span><span class=nt>&quot;detail&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Team &#39;team-alpha&#39; does not have access to model group &#39;ResumeAgent&#39;&quot;</span>
</span><span id=__span-27-3><a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a><span class=p>}</span>
</span></code></pre></div> <p>Status code: <code>403 Forbidden</code></p> <hr> <h2 id=common-operations>Common Operations<a class=headerlink href=#common-operations title="Permanent link">&para;</a></h2> <h3 id=1-create-model-group>1. Create Model Group<a class=headerlink href=#1-create-model-group title="Permanent link">&para;</a></h3> <div class="language-sql highlight"><pre><span></span><code><span id=__span-28-1><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=c1>-- Create group</span>
</span><span id=__span-28-2><a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>model_groups</span><span class=w> </span><span class=p>(</span><span class=n>group_name</span><span class=p>,</span><span class=w> </span><span class=n>display_name</span><span class=p>,</span><span class=w> </span><span class=n>description</span><span class=p>)</span>
</span><span id=__span-28-3><a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a><span class=k>VALUES</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-28-4><a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a><span class=w>    </span><span class=s1>&#39;ChatAgent&#39;</span><span class=p>,</span>
</span><span id=__span-28-5><a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a><span class=w>    </span><span class=s1>&#39;General Chat Agent&#39;</span><span class=p>,</span>
</span><span id=__span-28-6><a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a><span class=w>    </span><span class=s1>&#39;Conversational AI for customer support and general queries&#39;</span>
</span><span id=__span-28-7><a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a><span class=p>)</span>
</span><span id=__span-28-8><a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a><span class=n>RETURNING</span><span class=w> </span><span class=n>model_group_id</span><span class=p>;</span>
</span><span id=__span-28-9><a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a><span class=c1>-- Returns: &#39;xyz-uuid-789&#39;</span>
</span><span id=__span-28-10><a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a>
</span><span id=__span-28-11><a id=__codelineno-28-11 name=__codelineno-28-11 href=#__codelineno-28-11></a><span class=c1>-- Add models</span>
</span><span id=__span-28-12><a id=__codelineno-28-12 name=__codelineno-28-12 href=#__codelineno-28-12></a><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>model_group_models</span><span class=w> </span><span class=p>(</span><span class=n>model_group_id</span><span class=p>,</span><span class=w> </span><span class=n>model_name</span><span class=p>,</span><span class=w> </span><span class=n>priority</span><span class=p>)</span>
</span><span id=__span-28-13><a id=__codelineno-28-13 name=__codelineno-28-13 href=#__codelineno-28-13></a><span class=k>VALUES</span>
</span><span id=__span-28-14><a id=__codelineno-28-14 name=__codelineno-28-14 href=#__codelineno-28-14></a><span class=w>    </span><span class=p>(</span><span class=s1>&#39;xyz-uuid-789&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;gpt-4-turbo&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>),</span>
</span><span id=__span-28-15><a id=__codelineno-28-15 name=__codelineno-28-15 href=#__codelineno-28-15></a><span class=w>    </span><span class=p>(</span><span class=s1>&#39;xyz-uuid-789&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;gpt-3.5-turbo&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
</span></code></pre></div> <h3 id=2-assign-model-group-to-team>2. Assign Model Group to Team<a class=headerlink href=#2-assign-model-group-to-team title="Permanent link">&para;</a></h3> <div class="language-sql highlight"><pre><span></span><code><span id=__span-29-1><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>team_model_groups</span><span class=w> </span><span class=p>(</span><span class=n>team_id</span><span class=p>,</span><span class=w> </span><span class=n>model_group_id</span><span class=p>)</span>
</span><span id=__span-29-2><a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a><span class=k>SELECT</span><span class=w> </span><span class=s1>&#39;team-beta&#39;</span><span class=p>,</span><span class=w> </span><span class=n>model_group_id</span>
</span><span id=__span-29-3><a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a><span class=k>FROM</span><span class=w> </span><span class=n>model_groups</span>
</span><span id=__span-29-4><a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a><span class=k>WHERE</span><span class=w> </span><span class=n>group_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;ChatAgent&#39;</span><span class=p>;</span>
</span></code></pre></div> <h3 id=3-update-primary-model>3. Update Primary Model<a class=headerlink href=#3-update-primary-model title="Permanent link">&para;</a></h3> <div class="language-sql highlight"><pre><span></span><code><span id=__span-30-1><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=c1>-- Swap priorities to change primary</span>
</span><span id=__span-30-2><a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a><span class=k>UPDATE</span><span class=w> </span><span class=n>model_group_models</span>
</span><span id=__span-30-3><a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a><span class=k>SET</span><span class=w> </span><span class=n>priority</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>CASE</span>
</span><span id=__span-30-4><a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a><span class=w>    </span><span class=k>WHEN</span><span class=w> </span><span class=n>model_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;gpt-4-turbo&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-30-5><a id=__codelineno-30-5 name=__codelineno-30-5 href=#__codelineno-30-5></a><span class=w>    </span><span class=k>WHEN</span><span class=w> </span><span class=n>model_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;gpt-4&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>0</span>
</span><span id=__span-30-6><a id=__codelineno-30-6 name=__codelineno-30-6 href=#__codelineno-30-6></a><span class=k>END</span>
</span><span id=__span-30-7><a id=__codelineno-30-7 name=__codelineno-30-7 href=#__codelineno-30-7></a><span class=k>WHERE</span><span class=w> </span><span class=n>model_group_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-30-8><a id=__codelineno-30-8 name=__codelineno-30-8 href=#__codelineno-30-8></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>model_group_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>model_groups</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>group_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;ResumeAgent&#39;</span>
</span><span id=__span-30-9><a id=__codelineno-30-9 name=__codelineno-30-9 href=#__codelineno-30-9></a><span class=p>);</span>
</span></code></pre></div> <h3 id=4-add-fallback-model>4. Add Fallback Model<a class=headerlink href=#4-add-fallback-model title="Permanent link">&para;</a></h3> <div class="language-sql highlight"><pre><span></span><code><span id=__span-31-1><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>model_group_models</span><span class=w> </span><span class=p>(</span><span class=n>model_group_id</span><span class=p>,</span><span class=w> </span><span class=n>model_name</span><span class=p>,</span><span class=w> </span><span class=n>priority</span><span class=p>)</span>
</span><span id=__span-31-2><a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a><span class=k>SELECT</span>
</span><span id=__span-31-3><a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a><span class=w>    </span><span class=n>model_group_id</span><span class=p>,</span>
</span><span id=__span-31-4><a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a><span class=w>    </span><span class=s1>&#39;claude-3-opus&#39;</span><span class=p>,</span>
</span><span id=__span-31-5><a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a><span class=w>    </span><span class=mi>3</span><span class=w>  </span><span class=c1>-- Third fallback</span>
</span><span id=__span-31-6><a id=__codelineno-31-6 name=__codelineno-31-6 href=#__codelineno-31-6></a><span class=k>FROM</span><span class=w> </span><span class=n>model_groups</span>
</span><span id=__span-31-7><a id=__codelineno-31-7 name=__codelineno-31-7 href=#__codelineno-31-7></a><span class=k>WHERE</span><span class=w> </span><span class=n>group_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;ResumeAgent&#39;</span><span class=p>;</span>
</span></code></pre></div> <h3 id=5-disable-model-without-deletion>5. Disable Model (without deletion)<a class=headerlink href=#5-disable-model-without-deletion title="Permanent link">&para;</a></h3> <div class="language-sql highlight"><pre><span></span><code><span id=__span-32-1><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=k>UPDATE</span><span class=w> </span><span class=n>model_group_models</span>
</span><span id=__span-32-2><a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a><span class=k>SET</span><span class=w> </span><span class=n>is_active</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>FALSE</span>
</span><span id=__span-32-3><a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a><span class=k>WHERE</span><span class=w> </span><span class=n>model_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;gpt-3.5-turbo&#39;</span>
</span><span id=__span-32-4><a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a><span class=k>AND</span><span class=w> </span><span class=n>model_group_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-32-5><a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>model_group_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>model_groups</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>group_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;ResumeAgent&#39;</span>
</span><span id=__span-32-6><a id=__codelineno-32-6 name=__codelineno-32-6 href=#__codelineno-32-6></a><span class=p>);</span>
</span></code></pre></div> <h3 id=6-revoke-team-access>6. Revoke Team Access<a class=headerlink href=#6-revoke-team-access title="Permanent link">&para;</a></h3> <div class="language-sql highlight"><pre><span></span><code><span id=__span-33-1><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=k>DELETE</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>team_model_groups</span>
</span><span id=__span-33-2><a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a><span class=k>WHERE</span><span class=w> </span><span class=n>team_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;team-alpha&#39;</span>
</span><span id=__span-33-3><a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a><span class=k>AND</span><span class=w> </span><span class=n>model_group_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-33-4><a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>model_group_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>model_groups</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>group_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;ResumeAgent&#39;</span>
</span><span id=__span-33-5><a id=__codelineno-33-5 name=__codelineno-33-5 href=#__codelineno-33-5></a><span class=p>);</span>
</span></code></pre></div> <hr> <h2 id=analytics-queries>Analytics Queries<a class=headerlink href=#analytics-queries title="Permanent link">&para;</a></h2> <h3 id=model-group-usage-by-team>Model Group Usage by Team<a class=headerlink href=#model-group-usage-by-team title="Permanent link">&para;</a></h3> <div class="language-sql highlight"><pre><span></span><code><span id=__span-34-1><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=k>SELECT</span>
</span><span id=__span-34-2><a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a><span class=w>    </span><span class=n>llm</span><span class=p>.</span><span class=n>model_group_used</span><span class=p>,</span>
</span><span id=__span-34-3><a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a><span class=w>    </span><span class=n>llm</span><span class=p>.</span><span class=n>resolved_model</span><span class=p>,</span>
</span><span id=__span-34-4><a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a><span class=w>    </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>call_count</span><span class=p>,</span>
</span><span id=__span-34-5><a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a><span class=w>    </span><span class=k>AVG</span><span class=p>(</span><span class=n>llm</span><span class=p>.</span><span class=n>latency_ms</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>avg_latency_ms</span><span class=p>,</span>
</span><span id=__span-34-6><a id=__codelineno-34-6 name=__codelineno-34-6 href=#__codelineno-34-6></a><span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=n>llm</span><span class=p>.</span><span class=n>total_tokens</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>total_tokens</span><span class=p>,</span>
</span><span id=__span-34-7><a id=__codelineno-34-7 name=__codelineno-34-7 href=#__codelineno-34-7></a><span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=n>llm</span><span class=p>.</span><span class=n>cost_usd</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>total_cost_usd</span>
</span><span id=__span-34-8><a id=__codelineno-34-8 name=__codelineno-34-8 href=#__codelineno-34-8></a><span class=k>FROM</span><span class=w> </span><span class=n>llm_calls</span><span class=w> </span><span class=n>llm</span>
</span><span id=__span-34-9><a id=__codelineno-34-9 name=__codelineno-34-9 href=#__codelineno-34-9></a><span class=k>JOIN</span><span class=w> </span><span class=n>jobs</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>llm</span><span class=p>.</span><span class=n>job_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>j</span><span class=p>.</span><span class=n>job_id</span>
</span><span id=__span-34-10><a id=__codelineno-34-10 name=__codelineno-34-10 href=#__codelineno-34-10></a><span class=k>WHERE</span><span class=w> </span><span class=n>j</span><span class=p>.</span><span class=n>team_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;team-alpha&#39;</span>
</span><span id=__span-34-11><a id=__codelineno-34-11 name=__codelineno-34-11 href=#__codelineno-34-11></a><span class=k>AND</span><span class=w> </span><span class=n>llm</span><span class=p>.</span><span class=n>created_at</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=n>NOW</span><span class=p>()</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nb>INTERVAL</span><span class=w> </span><span class=s1>&#39;30 days&#39;</span>
</span><span id=__span-34-12><a id=__codelineno-34-12 name=__codelineno-34-12 href=#__codelineno-34-12></a><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>llm</span><span class=p>.</span><span class=n>model_group_used</span><span class=p>,</span><span class=w> </span><span class=n>llm</span><span class=p>.</span><span class=n>resolved_model</span>
</span><span id=__span-34-13><a id=__codelineno-34-13 name=__codelineno-34-13 href=#__codelineno-34-13></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>call_count</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span>
</span></code></pre></div> <h3 id=model-group-access-report>Model Group Access Report<a class=headerlink href=#model-group-access-report title="Permanent link">&para;</a></h3> <div class="language-sql highlight"><pre><span></span><code><span id=__span-35-1><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a><span class=k>SELECT</span>
</span><span id=__span-35-2><a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a><span class=w>    </span><span class=n>mg</span><span class=p>.</span><span class=n>group_name</span><span class=p>,</span>
</span><span id=__span-35-3><a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a><span class=w>    </span><span class=n>mg</span><span class=p>.</span><span class=n>display_name</span><span class=p>,</span>
</span><span id=__span-35-4><a id=__codelineno-35-4 name=__codelineno-35-4 href=#__codelineno-35-4></a><span class=w>    </span><span class=k>COUNT</span><span class=p>(</span><span class=k>DISTINCT</span><span class=w> </span><span class=n>tmg</span><span class=p>.</span><span class=n>team_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>team_count</span><span class=p>,</span>
</span><span id=__span-35-5><a id=__codelineno-35-5 name=__codelineno-35-5 href=#__codelineno-35-5></a><span class=w>    </span><span class=n>STRING_AGG</span><span class=p>(</span><span class=k>DISTINCT</span><span class=w> </span><span class=n>mgm</span><span class=p>.</span><span class=n>model_name</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;, &#39;</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>mgm</span><span class=p>.</span><span class=n>priority</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>models</span>
</span><span id=__span-35-6><a id=__codelineno-35-6 name=__codelineno-35-6 href=#__codelineno-35-6></a><span class=k>FROM</span><span class=w> </span><span class=n>model_groups</span><span class=w> </span><span class=n>mg</span>
</span><span id=__span-35-7><a id=__codelineno-35-7 name=__codelineno-35-7 href=#__codelineno-35-7></a><span class=k>LEFT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>team_model_groups</span><span class=w> </span><span class=n>tmg</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>mg</span><span class=p>.</span><span class=n>model_group_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>tmg</span><span class=p>.</span><span class=n>model_group_id</span>
</span><span id=__span-35-8><a id=__codelineno-35-8 name=__codelineno-35-8 href=#__codelineno-35-8></a><span class=k>LEFT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>model_group_models</span><span class=w> </span><span class=n>mgm</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>mg</span><span class=p>.</span><span class=n>model_group_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mgm</span><span class=p>.</span><span class=n>model_group_id</span>
</span><span id=__span-35-9><a id=__codelineno-35-9 name=__codelineno-35-9 href=#__codelineno-35-9></a><span class=k>WHERE</span><span class=w> </span><span class=n>mg</span><span class=p>.</span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;active&#39;</span>
</span><span id=__span-35-10><a id=__codelineno-35-10 name=__codelineno-35-10 href=#__codelineno-35-10></a><span class=k>AND</span><span class=w> </span><span class=n>mgm</span><span class=p>.</span><span class=n>is_active</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>TRUE</span>
</span><span id=__span-35-11><a id=__codelineno-35-11 name=__codelineno-35-11 href=#__codelineno-35-11></a><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>mg</span><span class=p>.</span><span class=n>group_name</span><span class=p>,</span><span class=w> </span><span class=n>mg</span><span class=p>.</span><span class=n>display_name</span>
</span><span id=__span-35-12><a id=__codelineno-35-12 name=__codelineno-35-12 href=#__codelineno-35-12></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>team_count</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span>
</span></code></pre></div> <h3 id=teams-without-model-group-access>Teams Without Model Group Access<a class=headerlink href=#teams-without-model-group-access title="Permanent link">&para;</a></h3> <div class="language-sql highlight"><pre><span></span><code><span id=__span-36-1><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>j</span><span class=p>.</span><span class=n>team_id</span>
</span><span id=__span-36-2><a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a><span class=k>FROM</span><span class=w> </span><span class=n>jobs</span><span class=w> </span><span class=n>j</span>
</span><span id=__span-36-3><a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a><span class=k>LEFT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>team_model_groups</span><span class=w> </span><span class=n>tmg</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>j</span><span class=p>.</span><span class=n>team_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>tmg</span><span class=p>.</span><span class=n>team_id</span>
</span><span id=__span-36-4><a id=__codelineno-36-4 name=__codelineno-36-4 href=#__codelineno-36-4></a><span class=k>WHERE</span><span class=w> </span><span class=n>tmg</span><span class=p>.</span><span class=n>team_id</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-36-5><a id=__codelineno-36-5 name=__codelineno-36-5 href=#__codelineno-36-5></a><span class=k>AND</span><span class=w> </span><span class=n>j</span><span class=p>.</span><span class=n>created_at</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=n>NOW</span><span class=p>()</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nb>INTERVAL</span><span class=w> </span><span class=s1>&#39;7 days&#39;</span><span class=p>;</span>
</span></code></pre></div> <hr> <h2 id=best-practices>Best Practices<a class=headerlink href=#best-practices title="Permanent link">&para;</a></h2> <h3 id=1-use-descriptive-group-names>1. Use Descriptive Group Names<a class=headerlink href=#1-use-descriptive-group-names title="Permanent link">&para;</a></h3> <div class="language-sql highlight"><pre><span></span><code><span id=__span-37-1><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=c1>-- ✅ Good - Clear purpose</span>
</span><span id=__span-37-2><a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a><span class=s1>&#39;ResumeAgent&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;DocumentParser&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;ChatAssistant&#39;</span>
</span><span id=__span-37-3><a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a>
</span><span id=__span-37-4><a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a><span class=c1>-- ❌ Bad - Unclear</span>
</span><span id=__span-37-5><a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a><span class=s1>&#39;Agent1&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;ModelA&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Default&#39;</span>
</span></code></pre></div> <h3 id=2-always-have-fallbacks>2. Always Have Fallbacks<a class=headerlink href=#2-always-have-fallbacks title="Permanent link">&para;</a></h3> <p>Configure at least 2 models per group for reliability:</p> <div class="language-sql highlight"><pre><span></span><code><span id=__span-38-1><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>model_group_models</span><span class=w> </span><span class=p>(</span><span class=n>model_group_id</span><span class=p>,</span><span class=w> </span><span class=n>model_name</span><span class=p>,</span><span class=w> </span><span class=n>priority</span><span class=p>)</span>
</span><span id=__span-38-2><a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a><span class=k>VALUES</span>
</span><span id=__span-38-3><a id=__codelineno-38-3 name=__codelineno-38-3 href=#__codelineno-38-3></a><span class=w>    </span><span class=p>(</span><span class=n>group_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;gpt-4-turbo&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>),</span><span class=w>      </span><span class=c1>-- Primary</span>
</span><span id=__span-38-4><a id=__codelineno-38-4 name=__codelineno-38-4 href=#__codelineno-38-4></a><span class=w>    </span><span class=p>(</span><span class=n>group_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;gpt-3.5-turbo&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>);</span><span class=w>    </span><span class=c1>-- Fallback</span>
</span></code></pre></div> <h3 id=3-test-model-changes>3. Test Model Changes<a class=headerlink href=#3-test-model-changes title="Permanent link">&para;</a></h3> <p>Before switching primary models, test with a subset of teams:</p> <div class="language-sql highlight"><pre><span></span><code><span id=__span-39-1><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a><span class=c1>-- Create test group with new model</span>
</span><span id=__span-39-2><a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>model_groups</span><span class=w> </span><span class=p>(</span><span class=n>group_name</span><span class=p>,</span><span class=w> </span><span class=n>display_name</span><span class=p>)</span>
</span><span id=__span-39-3><a id=__codelineno-39-3 name=__codelineno-39-3 href=#__codelineno-39-3></a><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;ResumeAgent-Beta&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Resume Agent (Testing GPT-4.5)&#39;</span><span class=p>);</span>
</span><span id=__span-39-4><a id=__codelineno-39-4 name=__codelineno-39-4 href=#__codelineno-39-4></a>
</span><span id=__span-39-5><a id=__codelineno-39-5 name=__codelineno-39-5 href=#__codelineno-39-5></a><span class=c1>-- Assign to test teams only</span>
</span><span id=__span-39-6><a id=__codelineno-39-6 name=__codelineno-39-6 href=#__codelineno-39-6></a><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>team_model_groups</span><span class=w> </span><span class=p>(</span><span class=n>team_id</span><span class=p>,</span><span class=w> </span><span class=n>model_group_id</span><span class=p>)</span>
</span><span id=__span-39-7><a id=__codelineno-39-7 name=__codelineno-39-7 href=#__codelineno-39-7></a><span class=k>SELECT</span><span class=w> </span><span class=s1>&#39;team-test&#39;</span><span class=p>,</span><span class=w> </span><span class=n>model_group_id</span>
</span><span id=__span-39-8><a id=__codelineno-39-8 name=__codelineno-39-8 href=#__codelineno-39-8></a><span class=k>FROM</span><span class=w> </span><span class=n>model_groups</span>
</span><span id=__span-39-9><a id=__codelineno-39-9 name=__codelineno-39-9 href=#__codelineno-39-9></a><span class=k>WHERE</span><span class=w> </span><span class=n>group_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;ResumeAgent-Beta&#39;</span><span class=p>;</span>
</span></code></pre></div> <h3 id=4-track-resolution-history>4. Track Resolution History<a class=headerlink href=#4-track-resolution-history title="Permanent link">&para;</a></h3> <p>The <code>llm_calls</code> table tracks both <code>model_group_used</code> and <code>resolved_model</code>, allowing you to: - See which groups are most popular - Identify when models change - Audit resolution decisions</p> <h3 id=5-document-model-group-purposes>5. Document Model Group Purposes<a class=headerlink href=#5-document-model-group-purposes title="Permanent link">&para;</a></h3> <p>Use the <code>description</code> field:</p> <div class="language-sql highlight"><pre><span></span><code><span id=__span-40-1><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a><span class=k>UPDATE</span><span class=w> </span><span class=n>model_groups</span>
</span><span id=__span-40-2><a id=__codelineno-40-2 name=__codelineno-40-2 href=#__codelineno-40-2></a><span class=k>SET</span><span class=w> </span><span class=n>description</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Use for: Resume parsing, skills extraction, job matching. Optimized for structured outputs. Fallback to GPT-4 if quota exceeded.&#39;</span>
</span><span id=__span-40-3><a id=__codelineno-40-3 name=__codelineno-40-3 href=#__codelineno-40-3></a><span class=k>WHERE</span><span class=w> </span><span class=n>group_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;ResumeAgent&#39;</span><span class=p>;</span>
</span></code></pre></div> <hr> <h2 id=advanced-patterns>Advanced Patterns<a class=headerlink href=#advanced-patterns title="Permanent link">&para;</a></h2> <h3 id=per-team-model-overrides>Per-Team Model Overrides<a class=headerlink href=#per-team-model-overrides title="Permanent link">&para;</a></h3> <p>Allow specific teams to use different models for the same group:</p> <div class="language-sql highlight"><pre><span></span><code><span id=__span-41-1><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a><span class=c1>-- Create team-specific variant</span>
</span><span id=__span-41-2><a id=__codelineno-41-2 name=__codelineno-41-2 href=#__codelineno-41-2></a><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>model_groups</span><span class=w> </span><span class=p>(</span><span class=n>group_name</span><span class=p>,</span><span class=w> </span><span class=n>display_name</span><span class=p>)</span>
</span><span id=__span-41-3><a id=__codelineno-41-3 name=__codelineno-41-3 href=#__codelineno-41-3></a><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;ResumeAgent-Premium&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Resume Agent (Enterprise)&#39;</span><span class=p>);</span>
</span><span id=__span-41-4><a id=__codelineno-41-4 name=__codelineno-41-4 href=#__codelineno-41-4></a>
</span><span id=__span-41-5><a id=__codelineno-41-5 name=__codelineno-41-5 href=#__codelineno-41-5></a><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>model_group_models</span><span class=w> </span><span class=p>(</span><span class=n>model_group_id</span><span class=p>,</span><span class=w> </span><span class=n>model_name</span><span class=p>,</span><span class=w> </span><span class=n>priority</span><span class=p>)</span>
</span><span id=__span-41-6><a id=__codelineno-41-6 name=__codelineno-41-6 href=#__codelineno-41-6></a><span class=k>SELECT</span><span class=w> </span><span class=n>model_group_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;gpt-4-turbo&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>0</span>
</span><span id=__span-41-7><a id=__codelineno-41-7 name=__codelineno-41-7 href=#__codelineno-41-7></a><span class=k>FROM</span><span class=w> </span><span class=n>model_groups</span>
</span><span id=__span-41-8><a id=__codelineno-41-8 name=__codelineno-41-8 href=#__codelineno-41-8></a><span class=k>WHERE</span><span class=w> </span><span class=n>group_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;ResumeAgent-Premium&#39;</span><span class=p>;</span>
</span><span id=__span-41-9><a id=__codelineno-41-9 name=__codelineno-41-9 href=#__codelineno-41-9></a>
</span><span id=__span-41-10><a id=__codelineno-41-10 name=__codelineno-41-10 href=#__codelineno-41-10></a><span class=c1>-- Assign premium version to enterprise team</span>
</span><span id=__span-41-11><a id=__codelineno-41-11 name=__codelineno-41-11 href=#__codelineno-41-11></a><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>team_model_groups</span><span class=w> </span><span class=p>(</span><span class=n>team_id</span><span class=p>,</span><span class=w> </span><span class=n>model_group_id</span><span class=p>)</span>
</span><span id=__span-41-12><a id=__codelineno-41-12 name=__codelineno-41-12 href=#__codelineno-41-12></a><span class=k>SELECT</span><span class=w> </span><span class=s1>&#39;team-enterprise&#39;</span><span class=p>,</span><span class=w> </span><span class=n>model_group_id</span>
</span><span id=__span-41-13><a id=__codelineno-41-13 name=__codelineno-41-13 href=#__codelineno-41-13></a><span class=k>FROM</span><span class=w> </span><span class=n>model_groups</span>
</span><span id=__span-41-14><a id=__codelineno-41-14 name=__codelineno-41-14 href=#__codelineno-41-14></a><span class=k>WHERE</span><span class=w> </span><span class=n>group_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;ResumeAgent-Premium&#39;</span><span class=p>;</span>
</span></code></pre></div> <h3 id=cost-based-routing>Cost-Based Routing<a class=headerlink href=#cost-based-routing title="Permanent link">&para;</a></h3> <p>Route to cheaper models for non-critical tasks:</p> <div class="language-sql highlight"><pre><span></span><code><span id=__span-42-1><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a><span class=c1>-- Budget model group</span>
</span><span id=__span-42-2><a id=__codelineno-42-2 name=__codelineno-42-2 href=#__codelineno-42-2></a><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>model_groups</span><span class=w> </span><span class=p>(</span><span class=n>group_name</span><span class=p>,</span><span class=w> </span><span class=n>display_name</span><span class=p>)</span>
</span><span id=__span-42-3><a id=__codelineno-42-3 name=__codelineno-42-3 href=#__codelineno-42-3></a><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;ChatAgent-Budget&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Chat Agent (Economy)&#39;</span><span class=p>);</span>
</span><span id=__span-42-4><a id=__codelineno-42-4 name=__codelineno-42-4 href=#__codelineno-42-4></a>
</span><span id=__span-42-5><a id=__codelineno-42-5 name=__codelineno-42-5 href=#__codelineno-42-5></a><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>model_group_models</span><span class=w> </span><span class=p>(</span><span class=n>model_group_id</span><span class=p>,</span><span class=w> </span><span class=n>model_name</span><span class=p>,</span><span class=w> </span><span class=n>priority</span><span class=p>)</span>
</span><span id=__span-42-6><a id=__codelineno-42-6 name=__codelineno-42-6 href=#__codelineno-42-6></a><span class=k>SELECT</span><span class=w> </span><span class=n>model_group_id</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;gpt-3.5-turbo&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>0</span>
</span><span id=__span-42-7><a id=__codelineno-42-7 name=__codelineno-42-7 href=#__codelineno-42-7></a><span class=k>FROM</span><span class=w> </span><span class=n>model_groups</span>
</span><span id=__span-42-8><a id=__codelineno-42-8 name=__codelineno-42-8 href=#__codelineno-42-8></a><span class=k>WHERE</span><span class=w> </span><span class=n>group_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;ChatAgent-Budget&#39;</span><span class=p>;</span>
</span><span id=__span-42-9><a id=__codelineno-42-9 name=__codelineno-42-9 href=#__codelineno-42-9></a>
</span><span id=__span-42-10><a id=__codelineno-42-10 name=__codelineno-42-10 href=#__codelineno-42-10></a><span class=c1>-- Assign to free-tier teams</span>
</span><span id=__span-42-11><a id=__codelineno-42-11 name=__codelineno-42-11 href=#__codelineno-42-11></a><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>team_model_groups</span><span class=w> </span><span class=p>(</span><span class=n>team_id</span><span class=p>,</span><span class=w> </span><span class=n>model_group_id</span><span class=p>)</span>
</span><span id=__span-42-12><a id=__codelineno-42-12 name=__codelineno-42-12 href=#__codelineno-42-12></a><span class=k>SELECT</span><span class=w> </span><span class=n>team_id</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>model_group_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>model_groups</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>group_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;ChatAgent-Budget&#39;</span><span class=p>)</span>
</span><span id=__span-42-13><a id=__codelineno-42-13 name=__codelineno-42-13 href=#__codelineno-42-13></a><span class=k>FROM</span><span class=w> </span><span class=n>team_credits</span>
</span><span id=__span-42-14><a id=__codelineno-42-14 name=__codelineno-42-14 href=#__codelineno-42-14></a><span class=k>WHERE</span><span class=w> </span><span class=n>credits_remaining</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>100</span><span class=p>;</span>
</span></code></pre></div> <h3 id=ab-testing-models>A/B Testing Models<a class=headerlink href=#ab-testing-models title="Permanent link">&para;</a></h3> <p>Split traffic between models to compare performance:</p> <div class="language-sql highlight"><pre><span></span><code><span id=__span-43-1><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a><span class=c1>-- Create A/B variants</span>
</span><span id=__span-43-2><a id=__codelineno-43-2 name=__codelineno-43-2 href=#__codelineno-43-2></a><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>model_groups</span><span class=w> </span><span class=p>(</span><span class=n>group_name</span><span class=p>,</span><span class=w> </span><span class=n>display_name</span><span class=p>)</span>
</span><span id=__span-43-3><a id=__codelineno-43-3 name=__codelineno-43-3 href=#__codelineno-43-3></a><span class=k>VALUES</span>
</span><span id=__span-43-4><a id=__codelineno-43-4 name=__codelineno-43-4 href=#__codelineno-43-4></a><span class=w>    </span><span class=p>(</span><span class=s1>&#39;ResumeAgent-A&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Resume Agent (GPT-4 Test)&#39;</span><span class=p>),</span>
</span><span id=__span-43-5><a id=__codelineno-43-5 name=__codelineno-43-5 href=#__codelineno-43-5></a><span class=w>    </span><span class=p>(</span><span class=s1>&#39;ResumeAgent-B&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Resume Agent (Claude Test)&#39;</span><span class=p>);</span>
</span><span id=__span-43-6><a id=__codelineno-43-6 name=__codelineno-43-6 href=#__codelineno-43-6></a>
</span><span id=__span-43-7><a id=__codelineno-43-7 name=__codelineno-43-7 href=#__codelineno-43-7></a><span class=c1>-- Configure models</span>
</span><span id=__span-43-8><a id=__codelineno-43-8 name=__codelineno-43-8 href=#__codelineno-43-8></a><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>model_group_models</span><span class=w> </span><span class=p>(</span><span class=n>model_group_id</span><span class=p>,</span><span class=w> </span><span class=n>model_name</span><span class=p>,</span><span class=w> </span><span class=n>priority</span><span class=p>)</span>
</span><span id=__span-43-9><a id=__codelineno-43-9 name=__codelineno-43-9 href=#__codelineno-43-9></a><span class=k>VALUES</span>
</span><span id=__span-43-10><a id=__codelineno-43-10 name=__codelineno-43-10 href=#__codelineno-43-10></a><span class=w>    </span><span class=p>((</span><span class=k>SELECT</span><span class=w> </span><span class=n>model_group_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>model_groups</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>group_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;ResumeAgent-A&#39;</span><span class=p>),</span><span class=w> </span><span class=s1>&#39;gpt-4-turbo&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>),</span>
</span><span id=__span-43-11><a id=__codelineno-43-11 name=__codelineno-43-11 href=#__codelineno-43-11></a><span class=w>    </span><span class=p>((</span><span class=k>SELECT</span><span class=w> </span><span class=n>model_group_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>model_groups</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>group_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;ResumeAgent-B&#39;</span><span class=p>),</span><span class=w> </span><span class=s1>&#39;claude-3-opus&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>);</span>
</span><span id=__span-43-12><a id=__codelineno-43-12 name=__codelineno-43-12 href=#__codelineno-43-12></a>
</span><span id=__span-43-13><a id=__codelineno-43-13 name=__codelineno-43-13 href=#__codelineno-43-13></a><span class=c1>-- Assign 50% of teams to each</span>
</span><span id=__span-43-14><a id=__codelineno-43-14 name=__codelineno-43-14 href=#__codelineno-43-14></a><span class=c1>-- (Application logic splits teams randomly)</span>
</span></code></pre></div> <hr> <h2 id=see-also>See Also<a class=headerlink href=#see-also title="Permanent link">&para;</a></h2> <ul> <li><a href=../database-schema/ >Database Schema Reference</a> - Model group table definitions</li> <li><a href=../api-reference/model-groups.md>API Reference: Model Groups</a> - Model group management endpoints</li> <li><a href=https://docs.litellm.ai/docs/providers>LiteLLM Model List</a> - Supported model identifiers</li> </ul> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../credit-system/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Credit System"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Credit System </div> </div> </a> <a href=../streaming-architecture/ class="md-footer__link md-footer__link--next" aria-label="Next: Streaming Architecture"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Streaming Architecture </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2024 Gittielabs, LLC. SaasLiteLLM is a product of Gittielabs, LLC. </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/GittieLabs/SaasLiteLLM target=_blank rel=noopener title="GitHub Repository" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top", "navigation.footer", "search.suggest", "search.highlight", "search.share", "toc.follow", "content.code.copy", "content.code.annotate", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.f55a23d4.min.js></script> <script src=../../javascripts/extra.js></script> </body> </html>